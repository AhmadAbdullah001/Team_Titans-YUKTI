{"ast":null,"code":"import{ethers}from\"ethers\";import abi from\"./abi.json\";import{HARDHAT_LOCALHOST_CHAIN_ID,contractAddress}from\"./contractconfig.js\";const LOCAL_RPC_URL=\"http://127.0.0.1:8545\";export function getLocalReadProvider(){return new ethers.JsonRpcProvider(LOCAL_RPC_URL);}export async function getBrowserProvider(){if(!window.ethereum){throw new Error(\"MetaMask not installed\");}return new ethers.BrowserProvider(window.ethereum);}export async function ensureWalletConnected(provider){const accounts=await provider.send(\"eth_accounts\",[]);if(accounts&&accounts.length>0){return accounts;}try{return await provider.send(\"eth_requestAccounts\",[]);}catch(error){if((error===null||error===void 0?void 0:error.code)===-32002){throw new Error(\"MetaMask request already pending. Open MetaMask and approve first.\");}throw error;}}export async function ensureCorrectNetwork(provider){const network=await provider.getNetwork();if(Number(network.chainId)===HARDHAT_LOCALHOST_CHAIN_ID){return;}const targetChainHex=\"0x\".concat(HARDHAT_LOCALHOST_CHAIN_ID.toString(16));try{await provider.send(\"wallet_switchEthereumChain\",[{chainId:targetChainHex}]);}catch(error){if((error===null||error===void 0?void 0:error.code)===4902){await provider.send(\"wallet_addEthereumChain\",[{chainId:targetChainHex,chainName:\"Hardhat Localhost\",rpcUrls:[LOCAL_RPC_URL],nativeCurrency:{name:\"ETH\",symbol:\"ETH\",decimals:18}}]);return;}throw new Error(\"Wrong network in MetaMask. Switch to Hardhat Localhost (chainId 31337).\");}}export async function ensureContractCode(provider){if(!contractAddress||contractAddress===\"0x0000000000000000000000000000000000000000\"){throw new Error(\"Contract address is not configured. Run blockchain deploy first.\");}const code=await provider.getCode(contractAddress);if(!code||code===\"0x\"){throw new Error(\"No contract found at \".concat(contractAddress,\". Redeploy and update config.\"));}}export function getReadOnlyContract(provider){return new ethers.Contract(contractAddress,abi,provider);}export function getWriteContract(signer){return new ethers.Contract(contractAddress,abi,signer);}","map":{"version":3,"names":["ethers","abi","HARDHAT_LOCALHOST_CHAIN_ID","contractAddress","LOCAL_RPC_URL","getLocalReadProvider","JsonRpcProvider","getBrowserProvider","window","ethereum","Error","BrowserProvider","ensureWalletConnected","provider","accounts","send","length","error","code","ensureCorrectNetwork","network","getNetwork","Number","chainId","targetChainHex","concat","toString","chainName","rpcUrls","nativeCurrency","name","symbol","decimals","ensureContractCode","getCode","getReadOnlyContract","Contract","getWriteContract","signer"],"sources":["C:/Users/ahmad/OneDrive/Desktop/evault/frontend/src/contract/eth.js"],"sourcesContent":["import { ethers } from \"ethers\";\nimport abi from \"./abi.json\";\nimport {\n  HARDHAT_LOCALHOST_CHAIN_ID,\n  contractAddress,\n} from \"./contractconfig.js\";\n\nconst LOCAL_RPC_URL = \"http://127.0.0.1:8545\";\n\nexport function getLocalReadProvider() {\n  return new ethers.JsonRpcProvider(LOCAL_RPC_URL);\n}\n\nexport async function getBrowserProvider() {\n  if (!window.ethereum) {\n    throw new Error(\"MetaMask not installed\");\n  }\n  return new ethers.BrowserProvider(window.ethereum);\n}\n\nexport async function ensureWalletConnected(provider) {\n  const accounts = await provider.send(\"eth_accounts\", []);\n  if (accounts && accounts.length > 0) {\n    return accounts;\n  }\n\n  try {\n    return await provider.send(\"eth_requestAccounts\", []);\n  } catch (error) {\n    if (error?.code === -32002) {\n      throw new Error(\n        \"MetaMask request already pending. Open MetaMask and approve first.\"\n      );\n    }\n    throw error;\n  }\n}\n\nexport async function ensureCorrectNetwork(provider) {\n  const network = await provider.getNetwork();\n  if (Number(network.chainId) === HARDHAT_LOCALHOST_CHAIN_ID) {\n    return;\n  }\n\n  const targetChainHex = `0x${HARDHAT_LOCALHOST_CHAIN_ID.toString(16)}`;\n  try {\n    await provider.send(\"wallet_switchEthereumChain\", [{ chainId: targetChainHex }]);\n  } catch (error) {\n    if (error?.code === 4902) {\n      await provider.send(\"wallet_addEthereumChain\", [\n        {\n          chainId: targetChainHex,\n          chainName: \"Hardhat Localhost\",\n          rpcUrls: [LOCAL_RPC_URL],\n          nativeCurrency: { name: \"ETH\", symbol: \"ETH\", decimals: 18 },\n        },\n      ]);\n      return;\n    }\n    throw new Error(\n      \"Wrong network in MetaMask. Switch to Hardhat Localhost (chainId 31337).\"\n    );\n  }\n}\n\nexport async function ensureContractCode(provider) {\n  if (\n    !contractAddress ||\n    contractAddress === \"0x0000000000000000000000000000000000000000\"\n  ) {\n    throw new Error(\n      \"Contract address is not configured. Run blockchain deploy first.\"\n    );\n  }\n\n  const code = await provider.getCode(contractAddress);\n  if (!code || code === \"0x\") {\n    throw new Error(\n      `No contract found at ${contractAddress}. Redeploy and update config.`\n    );\n  }\n}\n\nexport function getReadOnlyContract(provider) {\n  return new ethers.Contract(contractAddress, abi, provider);\n}\n\nexport function getWriteContract(signer) {\n  return new ethers.Contract(contractAddress, abi, signer);\n}\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}