{"ast":null,"code":"import { ethers } from \"ethers\";\nimport { getEVaultContract } from \"./web3.js\";\nexport function statusLabel(status) {\n  const value = Number(status);\n  if (value === 0) return \"Pending\";\n  if (value === 1) return \"Rejected\";\n  if (value === 2) return \"Registered\";\n  return \"Unknown\";\n}\nexport async function requestRegistration(ipfsHash) {\n  const contract = await getEVaultContract(true);\n  const tx = await contract.requestRegistration(ipfsHash);\n  await tx.wait();\n  return tx.hash;\n}\nexport async function approveProperty(propertyId) {\n  const contract = await getEVaultContract(true);\n  const tx = await contract.approveProperty(propertyId);\n  await tx.wait();\n  return tx.hash;\n}\nexport async function transferProperty(propertyId, newOwner) {\n  const contract = await getEVaultContract(true);\n  const tx = await contract.transferProperty(propertyId, newOwner);\n  await tx.wait();\n  return tx.hash;\n}\nexport async function verifyByBank(propertyId) {\n  const contract = await getEVaultContract(true);\n  const tx = await contract.verifyByBank(propertyId);\n  await tx.wait();\n  return tx.hash;\n}\nexport async function getPropertyCounter() {\n  const contract = await getEVaultContract(false);\n  return Number(await contract.propertyCounter());\n}\nexport async function getProperty(propertyId) {\n  const contract = await getEVaultContract(false);\n  const property = await contract.properties(propertyId);\n  return {\n    id: Number(property.id),\n    owner: property.owner,\n    ipfsHash: property.ipfsHash,\n    registrarApproved: Boolean(property.registrarApproved),\n    notaryApproved: Boolean(property.notaryApproved),\n    authorityApproved: Boolean(property.authorityApproved),\n    approvalCount: Number(property.approvalCount),\n    status: Number(property.status),\n    bankVerified: Boolean(property.bankVerified)\n  };\n}\nexport async function getAllProperties() {\n  const count = await getPropertyCounter();\n  if (count === 0) return [];\n  const ids = Array.from({\n    length: count\n  }, (_, i) => i + 1);\n  const properties = await Promise.all(ids.map(id => getProperty(id)));\n  return properties.filter(property => property.id > 0);\n}\nexport async function getOwnershipHistory(propertyId) {\n  const contract = await getEVaultContract(false);\n  const records = await contract.getOwnershipHistory(propertyId);\n  return records.map(record => ({\n    owner: record.owner,\n    timestamp: Number(record.timestamp),\n    readableTime: Number(record.timestamp) > 0 ? new Date(Number(record.timestamp) * 1000).toLocaleString() : \"-\"\n  }));\n}\nexport function isValidAddress(value) {\n  return ethers.isAddress(value);\n}","map":{"version":3,"names":["ethers","getEVaultContract","statusLabel","status","value","Number","requestRegistration","ipfsHash","contract","tx","wait","hash","approveProperty","propertyId","transferProperty","newOwner","verifyByBank","getPropertyCounter","propertyCounter","getProperty","property","properties","id","owner","registrarApproved","Boolean","notaryApproved","authorityApproved","approvalCount","bankVerified","getAllProperties","count","ids","Array","from","length","_","i","Promise","all","map","filter","getOwnershipHistory","records","record","timestamp","readableTime","Date","toLocaleString","isValidAddress","isAddress"],"sources":["C:/Users/ahmad/OneDrive/Desktop/evault/frontend/src/utils/evault.js"],"sourcesContent":["import { ethers } from \"ethers\";\nimport { getEVaultContract } from \"./web3.js\";\n\nexport function statusLabel(status) {\n  const value = Number(status);\n  if (value === 0) return \"Pending\";\n  if (value === 1) return \"Rejected\";\n  if (value === 2) return \"Registered\";\n  return \"Unknown\";\n}\n\nexport async function requestRegistration(ipfsHash) {\n  const contract = await getEVaultContract(true);\n  const tx = await contract.requestRegistration(ipfsHash);\n  await tx.wait();\n  return tx.hash;\n}\n\nexport async function approveProperty(propertyId) {\n  const contract = await getEVaultContract(true);\n  const tx = await contract.approveProperty(propertyId);\n  await tx.wait();\n  return tx.hash;\n}\n\nexport async function transferProperty(propertyId, newOwner) {\n  const contract = await getEVaultContract(true);\n  const tx = await contract.transferProperty(propertyId, newOwner);\n  await tx.wait();\n  return tx.hash;\n}\n\nexport async function verifyByBank(propertyId) {\n  const contract = await getEVaultContract(true);\n  const tx = await contract.verifyByBank(propertyId);\n  await tx.wait();\n  return tx.hash;\n}\n\nexport async function getPropertyCounter() {\n  const contract = await getEVaultContract(false);\n  return Number(await contract.propertyCounter());\n}\n\nexport async function getProperty(propertyId) {\n  const contract = await getEVaultContract(false);\n  const property = await contract.properties(propertyId);\n  return {\n    id: Number(property.id),\n    owner: property.owner,\n    ipfsHash: property.ipfsHash,\n    registrarApproved: Boolean(property.registrarApproved),\n    notaryApproved: Boolean(property.notaryApproved),\n    authorityApproved: Boolean(property.authorityApproved),\n    approvalCount: Number(property.approvalCount),\n    status: Number(property.status),\n    bankVerified: Boolean(property.bankVerified),\n  };\n}\n\nexport async function getAllProperties() {\n  const count = await getPropertyCounter();\n  if (count === 0) return [];\n  const ids = Array.from({ length: count }, (_, i) => i + 1);\n  const properties = await Promise.all(ids.map((id) => getProperty(id)));\n  return properties.filter((property) => property.id > 0);\n}\n\nexport async function getOwnershipHistory(propertyId) {\n  const contract = await getEVaultContract(false);\n  const records = await contract.getOwnershipHistory(propertyId);\n  return records.map((record) => ({\n    owner: record.owner,\n    timestamp: Number(record.timestamp),\n    readableTime:\n      Number(record.timestamp) > 0\n        ? new Date(Number(record.timestamp) * 1000).toLocaleString()\n        : \"-\",\n  }));\n}\n\nexport function isValidAddress(value) {\n  return ethers.isAddress(value);\n}\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}