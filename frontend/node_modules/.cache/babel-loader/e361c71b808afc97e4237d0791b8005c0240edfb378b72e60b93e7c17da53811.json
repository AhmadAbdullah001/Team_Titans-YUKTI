{"ast":null,"code":"import{ensureContractCode,ensureCorrectNetwork,ensureWalletConnected,getBrowserProvider,getReadOnlyContract,getWriteContract}from\"./eth.js\";async function getWriteReadyContract(){const provider=await getBrowserProvider();await ensureWalletConnected(provider);await ensureCorrectNetwork(provider);await ensureContractCode(provider);const signer=await provider.getSigner();return getWriteContract(signer);}async function getReadReadyContract(){const provider=await getBrowserProvider();await ensureWalletConnected(provider);await ensureCorrectNetwork(provider);await ensureContractCode(provider);return getReadOnlyContract(provider);}export async function registerPropertyOnChain(hash){const contract=await getWriteReadyContract();try{const tx=await contract.registerProperty(hash);await tx.wait();return tx.hash;}catch(error){const message=String((error===null||error===void 0?void 0:error.reason)||(error===null||error===void 0?void 0:error.shortMessage)||(error===null||error===void 0?void 0:error.message)||\"\");if(message.includes(\"is not a function\")||message.includes(\"missing revert data\")){const tx=await contract.storeHash(hash);await tx.wait();return tx.hash;}throw error;}}export async function approvePropertyOnChain(hash){const contract=await getWriteReadyContract();const tx=await contract.approveProperty(hash);await tx.wait();return tx.hash;}export async function verifyPropertyOnChain(hash){const contract=await getReadReadyContract();try{return await contract.verifyProperty(hash);}catch(_unused){return await contract.verifyHash(hash);}}export async function getPropertyOwnerOnChain(hash){const contract=await getReadReadyContract();try{return await contract.getOwner(hash);}catch(_unused2){return await contract.documentOwner(hash);}}","map":{"version":3,"names":["ensureContractCode","ensureCorrectNetwork","ensureWalletConnected","getBrowserProvider","getReadOnlyContract","getWriteContract","getWriteReadyContract","provider","signer","getSigner","getReadReadyContract","registerPropertyOnChain","hash","contract","tx","registerProperty","wait","error","message","String","reason","shortMessage","includes","storeHash","approvePropertyOnChain","approveProperty","verifyPropertyOnChain","verifyProperty","_unused","verifyHash","getPropertyOwnerOnChain","getOwner","_unused2","documentOwner"],"sources":["C:/Users/ahmad/OneDrive/Desktop/evault/frontend/src/contract/propertyActions.js"],"sourcesContent":["import {\n  ensureContractCode,\n  ensureCorrectNetwork,\n  ensureWalletConnected,\n  getBrowserProvider,\n  getReadOnlyContract,\n  getWriteContract,\n} from \"./eth.js\";\n\nasync function getWriteReadyContract() {\n  const provider = await getBrowserProvider();\n  await ensureWalletConnected(provider);\n  await ensureCorrectNetwork(provider);\n  await ensureContractCode(provider);\n  const signer = await provider.getSigner();\n  return getWriteContract(signer);\n}\n\nasync function getReadReadyContract() {\n  const provider = await getBrowserProvider();\n  await ensureWalletConnected(provider);\n  await ensureCorrectNetwork(provider);\n  await ensureContractCode(provider);\n  return getReadOnlyContract(provider);\n}\n\nexport async function registerPropertyOnChain(hash) {\n  const contract = await getWriteReadyContract();\n\n  try {\n    const tx = await contract.registerProperty(hash);\n    await tx.wait();\n    return tx.hash;\n  } catch (error) {\n    const message = String(error?.reason || error?.shortMessage || error?.message || \"\");\n    if (message.includes(\"is not a function\") || message.includes(\"missing revert data\")) {\n      const tx = await contract.storeHash(hash);\n      await tx.wait();\n      return tx.hash;\n    }\n    throw error;\n  }\n}\n\nexport async function approvePropertyOnChain(hash) {\n  const contract = await getWriteReadyContract();\n  const tx = await contract.approveProperty(hash);\n  await tx.wait();\n  return tx.hash;\n}\n\nexport async function verifyPropertyOnChain(hash) {\n  const contract = await getReadReadyContract();\n  try {\n    return await contract.verifyProperty(hash);\n  } catch {\n    return await contract.verifyHash(hash);\n  }\n}\n\nexport async function getPropertyOwnerOnChain(hash) {\n  const contract = await getReadReadyContract();\n  try {\n    return await contract.getOwner(hash);\n  } catch {\n    return await contract.documentOwner(hash);\n  }\n}\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}