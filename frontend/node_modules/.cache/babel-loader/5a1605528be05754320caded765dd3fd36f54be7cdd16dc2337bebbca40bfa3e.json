{"ast":null,"code":"import { ethers } from \"ethers\";\nimport abi from \"./abi.json\";\nimport { HARDHAT_LOCALHOST_CHAIN_ID, contractAddress } from \"./contractconfig.js\";\nconst LOCAL_RPC_URL = \"http://127.0.0.1:8545\";\nexport function getLocalReadProvider() {\n  return new ethers.JsonRpcProvider(LOCAL_RPC_URL);\n}\nexport async function getBrowserProvider() {\n  if (!window.ethereum) {\n    throw new Error(\"MetaMask not installed\");\n  }\n  return new ethers.BrowserProvider(window.ethereum);\n}\nexport async function ensureWalletConnected(provider) {\n  const accounts = await provider.send(\"eth_accounts\", []);\n  if (accounts && accounts.length > 0) {\n    return accounts;\n  }\n  try {\n    return await provider.send(\"eth_requestAccounts\", []);\n  } catch (error) {\n    if ((error === null || error === void 0 ? void 0 : error.code) === -32002) {\n      throw new Error(\"MetaMask request already pending. Open MetaMask and approve first.\");\n    }\n    throw error;\n  }\n}\nexport async function ensureCorrectNetwork(provider) {\n  const network = await provider.getNetwork();\n  if (Number(network.chainId) === HARDHAT_LOCALHOST_CHAIN_ID) {\n    return;\n  }\n  const targetChainHex = `0x${HARDHAT_LOCALHOST_CHAIN_ID.toString(16)}`;\n  try {\n    await provider.send(\"wallet_switchEthereumChain\", [{\n      chainId: targetChainHex\n    }]);\n  } catch (error) {\n    if ((error === null || error === void 0 ? void 0 : error.code) === 4902) {\n      await provider.send(\"wallet_addEthereumChain\", [{\n        chainId: targetChainHex,\n        chainName: \"Hardhat Localhost\",\n        rpcUrls: [LOCAL_RPC_URL],\n        nativeCurrency: {\n          name: \"ETH\",\n          symbol: \"ETH\",\n          decimals: 18\n        }\n      }]);\n      return;\n    }\n    throw new Error(\"Wrong network in MetaMask. Switch to Hardhat Localhost (chainId 31337).\");\n  }\n}\nexport async function ensureContractCode(provider) {\n  if (!contractAddress || contractAddress === \"0x0000000000000000000000000000000000000000\") {\n    throw new Error(\"Contract address is not configured. Run blockchain deploy first.\");\n  }\n  const code = await provider.getCode(contractAddress);\n  if (!code || code === \"0x\") {\n    throw new Error(`No contract found at ${contractAddress}. Redeploy and update config.`);\n  }\n}\nexport function getReadOnlyContract(provider) {\n  return new ethers.Contract(contractAddress, abi, provider);\n}\nexport function getWriteContract(signer) {\n  return new ethers.Contract(contractAddress, abi, signer);\n}","map":{"version":3,"names":["ethers","abi","HARDHAT_LOCALHOST_CHAIN_ID","contractAddress","LOCAL_RPC_URL","getLocalReadProvider","JsonRpcProvider","getBrowserProvider","window","ethereum","Error","BrowserProvider","ensureWalletConnected","provider","accounts","send","length","error","code","ensureCorrectNetwork","network","getNetwork","Number","chainId","targetChainHex","toString","chainName","rpcUrls","nativeCurrency","name","symbol","decimals","ensureContractCode","getCode","getReadOnlyContract","Contract","getWriteContract","signer"],"sources":["C:/Users/ahmad/OneDrive/Desktop/evault/frontend/src/contract/eth.js"],"sourcesContent":["import { ethers } from \"ethers\";\nimport abi from \"./abi.json\";\nimport {\n  HARDHAT_LOCALHOST_CHAIN_ID,\n  contractAddress,\n} from \"./contractconfig.js\";\n\nconst LOCAL_RPC_URL = \"http://127.0.0.1:8545\";\n\nexport function getLocalReadProvider() {\n  return new ethers.JsonRpcProvider(LOCAL_RPC_URL);\n}\n\nexport async function getBrowserProvider() {\n  if (!window.ethereum) {\n    throw new Error(\"MetaMask not installed\");\n  }\n  return new ethers.BrowserProvider(window.ethereum);\n}\n\nexport async function ensureWalletConnected(provider) {\n  const accounts = await provider.send(\"eth_accounts\", []);\n  if (accounts && accounts.length > 0) {\n    return accounts;\n  }\n\n  try {\n    return await provider.send(\"eth_requestAccounts\", []);\n  } catch (error) {\n    if (error?.code === -32002) {\n      throw new Error(\n        \"MetaMask request already pending. Open MetaMask and approve first.\"\n      );\n    }\n    throw error;\n  }\n}\n\nexport async function ensureCorrectNetwork(provider) {\n  const network = await provider.getNetwork();\n  if (Number(network.chainId) === HARDHAT_LOCALHOST_CHAIN_ID) {\n    return;\n  }\n\n  const targetChainHex = `0x${HARDHAT_LOCALHOST_CHAIN_ID.toString(16)}`;\n  try {\n    await provider.send(\"wallet_switchEthereumChain\", [{ chainId: targetChainHex }]);\n  } catch (error) {\n    if (error?.code === 4902) {\n      await provider.send(\"wallet_addEthereumChain\", [\n        {\n          chainId: targetChainHex,\n          chainName: \"Hardhat Localhost\",\n          rpcUrls: [LOCAL_RPC_URL],\n          nativeCurrency: { name: \"ETH\", symbol: \"ETH\", decimals: 18 },\n        },\n      ]);\n      return;\n    }\n    throw new Error(\n      \"Wrong network in MetaMask. Switch to Hardhat Localhost (chainId 31337).\"\n    );\n  }\n}\n\nexport async function ensureContractCode(provider) {\n  if (\n    !contractAddress ||\n    contractAddress === \"0x0000000000000000000000000000000000000000\"\n  ) {\n    throw new Error(\n      \"Contract address is not configured. Run blockchain deploy first.\"\n    );\n  }\n\n  const code = await provider.getCode(contractAddress);\n  if (!code || code === \"0x\") {\n    throw new Error(\n      `No contract found at ${contractAddress}. Redeploy and update config.`\n    );\n  }\n}\n\nexport function getReadOnlyContract(provider) {\n  return new ethers.Contract(contractAddress, abi, provider);\n}\n\nexport function getWriteContract(signer) {\n  return new ethers.Contract(contractAddress, abi, signer);\n}\n"],"mappings":"AAAA,SAASA,MAAM,QAAQ,QAAQ;AAC/B,OAAOC,GAAG,MAAM,YAAY;AAC5B,SACEC,0BAA0B,EAC1BC,eAAe,QACV,qBAAqB;AAE5B,MAAMC,aAAa,GAAG,uBAAuB;AAE7C,OAAO,SAASC,oBAAoBA,CAAA,EAAG;EACrC,OAAO,IAAIL,MAAM,CAACM,eAAe,CAACF,aAAa,CAAC;AAClD;AAEA,OAAO,eAAeG,kBAAkBA,CAAA,EAAG;EACzC,IAAI,CAACC,MAAM,CAACC,QAAQ,EAAE;IACpB,MAAM,IAAIC,KAAK,CAAC,wBAAwB,CAAC;EAC3C;EACA,OAAO,IAAIV,MAAM,CAACW,eAAe,CAACH,MAAM,CAACC,QAAQ,CAAC;AACpD;AAEA,OAAO,eAAeG,qBAAqBA,CAACC,QAAQ,EAAE;EACpD,MAAMC,QAAQ,GAAG,MAAMD,QAAQ,CAACE,IAAI,CAAC,cAAc,EAAE,EAAE,CAAC;EACxD,IAAID,QAAQ,IAAIA,QAAQ,CAACE,MAAM,GAAG,CAAC,EAAE;IACnC,OAAOF,QAAQ;EACjB;EAEA,IAAI;IACF,OAAO,MAAMD,QAAQ,CAACE,IAAI,CAAC,qBAAqB,EAAE,EAAE,CAAC;EACvD,CAAC,CAAC,OAAOE,KAAK,EAAE;IACd,IAAI,CAAAA,KAAK,aAALA,KAAK,uBAALA,KAAK,CAAEC,IAAI,MAAK,CAAC,KAAK,EAAE;MAC1B,MAAM,IAAIR,KAAK,CACb,oEACF,CAAC;IACH;IACA,MAAMO,KAAK;EACb;AACF;AAEA,OAAO,eAAeE,oBAAoBA,CAACN,QAAQ,EAAE;EACnD,MAAMO,OAAO,GAAG,MAAMP,QAAQ,CAACQ,UAAU,CAAC,CAAC;EAC3C,IAAIC,MAAM,CAACF,OAAO,CAACG,OAAO,CAAC,KAAKrB,0BAA0B,EAAE;IAC1D;EACF;EAEA,MAAMsB,cAAc,GAAG,KAAKtB,0BAA0B,CAACuB,QAAQ,CAAC,EAAE,CAAC,EAAE;EACrE,IAAI;IACF,MAAMZ,QAAQ,CAACE,IAAI,CAAC,4BAA4B,EAAE,CAAC;MAAEQ,OAAO,EAAEC;IAAe,CAAC,CAAC,CAAC;EAClF,CAAC,CAAC,OAAOP,KAAK,EAAE;IACd,IAAI,CAAAA,KAAK,aAALA,KAAK,uBAALA,KAAK,CAAEC,IAAI,MAAK,IAAI,EAAE;MACxB,MAAML,QAAQ,CAACE,IAAI,CAAC,yBAAyB,EAAE,CAC7C;QACEQ,OAAO,EAAEC,cAAc;QACvBE,SAAS,EAAE,mBAAmB;QAC9BC,OAAO,EAAE,CAACvB,aAAa,CAAC;QACxBwB,cAAc,EAAE;UAAEC,IAAI,EAAE,KAAK;UAAEC,MAAM,EAAE,KAAK;UAAEC,QAAQ,EAAE;QAAG;MAC7D,CAAC,CACF,CAAC;MACF;IACF;IACA,MAAM,IAAIrB,KAAK,CACb,yEACF,CAAC;EACH;AACF;AAEA,OAAO,eAAesB,kBAAkBA,CAACnB,QAAQ,EAAE;EACjD,IACE,CAACV,eAAe,IAChBA,eAAe,KAAK,4CAA4C,EAChE;IACA,MAAM,IAAIO,KAAK,CACb,kEACF,CAAC;EACH;EAEA,MAAMQ,IAAI,GAAG,MAAML,QAAQ,CAACoB,OAAO,CAAC9B,eAAe,CAAC;EACpD,IAAI,CAACe,IAAI,IAAIA,IAAI,KAAK,IAAI,EAAE;IAC1B,MAAM,IAAIR,KAAK,CACb,wBAAwBP,eAAe,+BACzC,CAAC;EACH;AACF;AAEA,OAAO,SAAS+B,mBAAmBA,CAACrB,QAAQ,EAAE;EAC5C,OAAO,IAAIb,MAAM,CAACmC,QAAQ,CAAChC,eAAe,EAAEF,GAAG,EAAEY,QAAQ,CAAC;AAC5D;AAEA,OAAO,SAASuB,gBAAgBA,CAACC,MAAM,EAAE;EACvC,OAAO,IAAIrC,MAAM,CAACmC,QAAQ,CAAChC,eAAe,EAAEF,GAAG,EAAEoC,MAAM,CAAC;AAC1D","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}