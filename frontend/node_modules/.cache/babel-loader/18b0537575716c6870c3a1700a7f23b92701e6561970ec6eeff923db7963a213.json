{"ast":null,"code":"import{ethers}from\"ethers\";import{EVAULT_ADDRESS}from\"./config.js\";import{EVAULT_ABI}from\"./evaultAbi.js\";const WALLET_KEY=\"evault_wallet\";function ensureWallet(){if(!window.ethereum){throw new Error(\"MetaMask is required.\");}}export async function connectWallet(){ensureWallet();const provider=new ethers.BrowserProvider(window.ethereum);const accounts=await provider.send(\"eth_requestAccounts\",[]);const network=await provider.getNetwork();const wallet={address:accounts[0],chainId:network.chainId.toString()};localStorage.setItem(WALLET_KEY,JSON.stringify(wallet));return wallet;}export function getSavedWallet(){try{return JSON.parse(localStorage.getItem(WALLET_KEY)||\"null\");}catch(_unused){return null;}}export async function getProvider(){ensureWallet();return new ethers.BrowserProvider(window.ethereum);}export async function getSigner(){const provider=await getProvider();return provider.getSigner();}export async function getEVaultContract(){let withSigner=arguments.length>0&&arguments[0]!==undefined?arguments[0]:false;if(!EVAULT_ADDRESS||EVAULT_ADDRESS===ethers.ZeroAddress){throw new Error(\"Set REACT_APP_EVAULT_ADDRESS in frontend/.env\");}if(withSigner){const signer=await getSigner();return new ethers.Contract(EVAULT_ADDRESS,EVAULT_ABI,signer);}const provider=await getProvider();return new ethers.Contract(EVAULT_ADDRESS,EVAULT_ABI,provider);}export function shortAddress(address){if(!address)return\"\";const v=String(address);return\"\".concat(v.slice(0,6),\"...\").concat(v.slice(-4));}","map":{"version":3,"names":["ethers","EVAULT_ADDRESS","EVAULT_ABI","WALLET_KEY","ensureWallet","window","ethereum","Error","connectWallet","provider","BrowserProvider","accounts","send","network","getNetwork","wallet","address","chainId","toString","localStorage","setItem","JSON","stringify","getSavedWallet","parse","getItem","_unused","getProvider","getSigner","getEVaultContract","withSigner","arguments","length","undefined","ZeroAddress","signer","Contract","shortAddress","v","String","concat","slice"],"sources":["C:/Users/ahmad/OneDrive/Desktop/evault/frontend/src/utils/web3.js"],"sourcesContent":["import { ethers } from \"ethers\";\nimport { EVAULT_ADDRESS } from \"./config.js\";\nimport { EVAULT_ABI } from \"./evaultAbi.js\";\n\nconst WALLET_KEY = \"evault_wallet\";\n\nfunction ensureWallet() {\n  if (!window.ethereum) {\n    throw new Error(\"MetaMask is required.\");\n  }\n}\n\nexport async function connectWallet() {\n  ensureWallet();\n  const provider = new ethers.BrowserProvider(window.ethereum);\n  const accounts = await provider.send(\"eth_requestAccounts\", []);\n  const network = await provider.getNetwork();\n  const wallet = {\n    address: accounts[0],\n    chainId: network.chainId.toString(),\n  };\n  localStorage.setItem(WALLET_KEY, JSON.stringify(wallet));\n  return wallet;\n}\n\nexport function getSavedWallet() {\n  try {\n    return JSON.parse(localStorage.getItem(WALLET_KEY) || \"null\");\n  } catch {\n    return null;\n  }\n}\n\nexport async function getProvider() {\n  ensureWallet();\n  return new ethers.BrowserProvider(window.ethereum);\n}\n\nexport async function getSigner() {\n  const provider = await getProvider();\n  return provider.getSigner();\n}\n\nexport async function getEVaultContract(withSigner = false) {\n  if (!EVAULT_ADDRESS || EVAULT_ADDRESS === ethers.ZeroAddress) {\n    throw new Error(\"Set REACT_APP_EVAULT_ADDRESS in frontend/.env\");\n  }\n  if (withSigner) {\n    const signer = await getSigner();\n    return new ethers.Contract(EVAULT_ADDRESS, EVAULT_ABI, signer);\n  }\n  const provider = await getProvider();\n  return new ethers.Contract(EVAULT_ADDRESS, EVAULT_ABI, provider);\n}\n\nexport function shortAddress(address) {\n  if (!address) return \"\";\n  const v = String(address);\n  return `${v.slice(0, 6)}...${v.slice(-4)}`;\n}\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}