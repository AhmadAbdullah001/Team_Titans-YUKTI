{"ast":null,"code":"import _objectSpread from\"C:/Users/ahmad/OneDrive/Desktop/evault/frontend/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import React,{useEffect,useState}from\"react\";import{Link}from\"react-router-dom\";import{useNavigate}from\"react-router-dom\";import{pushHashOnChainWithWallet,getPropertyHistoryOnChain,getPropertyOwnerOnChain,propertyExistsOnChain,verifyPropertyOnChain}from\"../contract/propertyActions.js\";import{jsxs as _jsxs,jsx as _jsx}from\"react/jsx-runtime\";const API_BASE=\"http://localhost:5000\";const ZERO_ADDRESS=\"0x0000000000000000000000000000000000000000\";async function parseJsonSafe(response){const contentType=response.headers.get(\"content-type\")||\"\";if(!contentType.includes(\"application/json\")){const text=await response.text();throw new Error(\"API did not return JSON. Response started with: \".concat(text.slice(0,40)));}return response.json();}function maskHash(hash){const value=String(hash||\"\").trim();if(!value)return\"-\";if(value.length<=14)return value;return\"\".concat(value.slice(0,8),\"...\").concat(value.slice(-6));}function maskValue(value){const text=String(value||\"\").trim();if(!text)return\"-\";if(text.length<=10)return text;return\"\".concat(text.slice(0,4),\"...\").concat(text.slice(-4));}function getYearLabel(value){if(!value)return\"----\";const date=new Date(value);if(Number.isNaN(date.getTime()))return\"----\";return String(date.getFullYear());}function RegistrarDashboard(){const navigate=useNavigate();const currentRole=String(localStorage.getItem(\"role\")||\"\").trim();const normalizedRole=currentRole===\"localAuthority\"?\"localauthority\":currentRole.toLowerCase();const isReviewerRole=[\"registrar\",\"notary\",\"localauthority\"].includes(normalizedRole);const roleLabel=currentRole===\"localAuthority\"?\"Local Authority\":currentRole?currentRole.charAt(0).toUpperCase()+currentRole.slice(1):\"Registrar\";const[files,setFiles]=useState([]);const[loading,setLoading]=useState(false);const[actionMessage,setActionMessage]=useState(\"\");const[processingHash,setProcessingHash]=useState(\"\");const[historyByHash,setHistoryByHash]=useState({});const[loadingHistoryHash,setLoadingHistoryHash]=useState(\"\");const[searchHash,setSearchHash]=useState(\"\");const[searchingOwner,setSearchingOwner]=useState(false);const[ownerDetails,setOwnerDetails]=useState(null);const[ownerSearchMessage,setOwnerSearchMessage]=useState(\"\");const[walletLabels,setWalletLabels]=useState({});const logout=()=>{localStorage.removeItem(\"user\");localStorage.removeItem(\"role\");navigate(\"/login\",{replace:true});};const loadFiles=async()=>{if(!isReviewerRole){setActionMessage(\"Only registrar, notary, and local authority can review requests.\");setFiles([]);return;}setLoading(true);try{var _data2;let response=await fetch(\"\".concat(API_BASE,\"/api/files?role=\").concat(encodeURIComponent(currentRole)),{headers:{\"x-role\":currentRole}});let data;try{data=await parseJsonSafe(response);}catch(_unused){// Backward-compatible fallback to existing upload listing endpoint.\nresponse=await fetch(\"\".concat(API_BASE,\"/api/upload/all\"));data=await parseJsonSafe(response);}if(!response.ok){var _data;throw new Error(((_data=data)===null||_data===void 0?void 0:_data.message)||\"Failed to fetch files\");}const rows=Array.isArray((_data2=data)===null||_data2===void 0?void 0:_data2.files)?data.files:[];const withStatus=await Promise.all(rows.map(async item=>{let existsOnChain=null;let verifiedOnChain=false;let currentOwnerWallet=item.currentOwnerWallet||null;let transferHistoryCount=null;try{existsOnChain=await propertyExistsOnChain(item.ipfshash);}catch(_unused2){existsOnChain=null;}try{verifiedOnChain=await verifyPropertyOnChain(item.ipfshash);}catch(_unused3){verifiedOnChain=false;}try{currentOwnerWallet=await getPropertyOwnerOnChain(item.ipfshash);}catch(_unused4){// no-op\n}try{const history=await getPropertyHistoryOnChain(item.ipfshash);transferHistoryCount=Array.isArray(history)?history.filter(record=>{const from=String((record===null||record===void 0?void 0:record.from)||\"\").toLowerCase();const to=String((record===null||record===void 0?void 0:record.to)||\"\").toLowerCase();return from&&to&&from!==ZERO_ADDRESS&&to!==ZERO_ADDRESS;}).length:0;}catch(_unused5){transferHistoryCount=null;}return _objectSpread(_objectSpread({},item),{},{existsOnChain,verifiedOnChain:Boolean(verifiedOnChain),currentOwnerWallet,transferHistoryCount});}));setFiles(withStatus);}catch(error){setActionMessage((error===null||error===void 0?void 0:error.message)||\"Failed to load files. Ensure backend is running on http://localhost:5000.\");}finally{setLoading(false);}};useEffect(()=>{loadFiles();},[]);// eslint-disable-line react-hooks/exhaustive-deps\nconst reviewRequest=async function(hash,decision){let rejectionReason=arguments.length>2&&arguments[2]!==undefined?arguments[2]:\"\";try{var _data4;setProcessingHash(hash);setActionMessage(decision===\"approve\"?\"Submitting approval...\":\"Submitting rejection...\");const response=await fetch(\"\".concat(API_BASE,\"/api/files/review\"),{method:\"PATCH\",headers:{\"Content-Type\":\"application/json\",\"x-role\":currentRole},body:JSON.stringify({hash,role:currentRole,reviewerWallet:localStorage.getItem(\"walletAddress\")||null,decision,rejectionReason:rejectionReason||null})});const contentType=response.headers.get(\"content-type\")||\"\";let data=null;if(contentType.includes(\"application/json\")){data=await response.json();}else{const raw=await response.text();if(response.status===404){throw new Error(\"Review API not found. Restart backend so /api/files/review route is loaded.\");}throw new Error(\"Review API returned non-JSON response (status \".concat(response.status,\"). Response starts with: \").concat(raw.replace(/\\s+/g,\" \").slice(0,80)));}if(!response.ok){var _data3;throw new Error(((_data3=data)===null||_data3===void 0?void 0:_data3.message)||\"Failed to submit review\");}setActionMessage(((_data4=data)===null||_data4===void 0?void 0:_data4.message)||\"Review submitted.\");await loadFiles();}catch(error){setActionMessage((error===null||error===void 0?void 0:error.message)||\"Review failed\");}finally{setProcessingHash(\"\");}};const handleReject=hash=>{const reason=window.prompt(\"Enter rejection reason (mandatory):\",\"\");if(!reason||!String(reason).trim()){setActionMessage(\"Rejection reason is required.\");return;}reviewRequest(hash,\"reject\",String(reason).trim());};const retryChainPush=async hash=>{try{setProcessingHash(hash);setActionMessage(\"Waiting for MetaMask confirmation...\");const txHash=await pushHashOnChainWithWallet(hash);setActionMessage(\"MetaMask tx confirmed. Syncing backend status...\");const response=await fetch(\"\".concat(API_BASE,\"/api/files/confirm-chain-push\"),{method:\"PATCH\",headers:{\"Content-Type\":\"application/json\",\"x-role\":currentRole},body:JSON.stringify({hash,role:currentRole,txHash})});const data=await parseJsonSafe(response);if(!response.ok){throw new Error((data===null||data===void 0?void 0:data.message)||\"Retry failed\");}setActionMessage(\"\".concat((data===null||data===void 0?void 0:data.message)||\"Blockchain push successful.\").concat(txHash?\" Tx: \".concat(txHash):\"\"));await loadFiles();}catch(error){setActionMessage((error===null||error===void 0?void 0:error.message)||\"Retry failed\");}finally{setProcessingHash(\"\");}};const resolveWalletLabel=async wallet=>{const normalized=String(wallet||\"\").trim().toLowerCase();if(!normalized||normalized===ZERO_ADDRESS)return\"System\";if(walletLabels[normalized])return walletLabels[normalized];try{var _data$user;const response=await fetch(\"\".concat(API_BASE,\"/api/auth/user-by-wallet/\").concat(encodeURIComponent(normalized),\"?role=\").concat(encodeURIComponent(currentRole)),{headers:{\"x-role\":currentRole}});const data=await parseJsonSafe(response);if(response.ok&&data!==null&&data!==void 0&&(_data$user=data.user)!==null&&_data$user!==void 0&&_data$user.name){const label=\"\".concat(data.user.name,\" (\").concat(maskValue(normalized),\")\");setWalletLabels(prev=>_objectSpread(_objectSpread({},prev),{},{[normalized]:label}));return label;}}catch(_unused6){// fallback below\n}const fallback=maskValue(normalized);setWalletLabels(prev=>_objectSpread(_objectSpread({},prev),{},{[normalized]:fallback}));return fallback;};const loadHistory=async item=>{const hash=String((item===null||item===void 0?void 0:item.ipfshash)||\"\").trim();if(!hash)return;try{setLoadingHistoryHash(hash);const timeline=[];timeline.push(\"\".concat(getYearLabel(item===null||item===void 0?void 0:item.uploadedAt),\" - Requested (\").concat(String((item===null||item===void 0?void 0:item.userID)||\"Citizen\"),\")\"));const decisionRows=Object.entries((item===null||item===void 0?void 0:item.roleDecisions)||{}).map(_ref=>{let[role,value]=_ref;return{role,decision:(value===null||value===void 0?void 0:value.decision)||null,reason:(value===null||value===void 0?void 0:value.reason)||null,by:(value===null||value===void 0?void 0:value.by)||null,at:(value===null||value===void 0?void 0:value.at)||null};}).filter(row=>row.decision&&row.at).sort((a,b)=>new Date(a.at).getTime()-new Date(b.at).getTime());for(const row of decisionRows){const actor=row.by?await resolveWalletLabel(row.by):row.role;const roleLabelText=row.role===\"localAuthority\"?\"Local Authority\":row.role.charAt(0).toUpperCase()+row.role.slice(1);if(row.decision===\"approve\"){timeline.push(\"\".concat(getYearLabel(row.at),\" - Approved by \").concat(roleLabelText,\" (\").concat(actor,\")\"));}else{timeline.push(\"\".concat(getYearLabel(row.at),\" - Rejected by \").concat(roleLabelText,\" (\").concat(actor,\")\").concat(row.reason?\" | Reason: \".concat(row.reason):\"\"));}}if(item!==null&&item!==void 0&&item.chainPushedAt){timeline.push(\"\".concat(getYearLabel(item.chainPushedAt),\" - Registered on Blockchain\").concat(item.chainTxHash?\" (Tx: \".concat(maskValue(item.chainTxHash),\")\"):\"\"));}try{const chainHistory=await getPropertyHistoryOnChain(hash);const chainRows=Array.isArray(chainHistory)?chainHistory:[];for(const record of chainRows){const from=String((record===null||record===void 0?void 0:record.from)||\"\").toLowerCase();const to=String((record===null||record===void 0?void 0:record.to)||\"\").toLowerCase();const ts=Number((record===null||record===void 0?void 0:record.timestamp)||0);if(!to||to===ZERO_ADDRESS)continue;const toLabel=await resolveWalletLabel(to);if(!from||from===ZERO_ADDRESS){timeline.push(\"\".concat(getYearLabel(ts?ts*1000:null),\" - Registered (\").concat(toLabel,\")\"));}else{const fromLabel=await resolveWalletLabel(from);timeline.push(\"\".concat(getYearLabel(ts?ts*1000:null),\" - Transferred (\").concat(fromLabel,\" -> \").concat(toLabel,\")\"));}}}catch(_unused7){// chain history optional\n}if((item===null||item===void 0?void 0:item.workflowStatus)===\"rejected\"){timeline.push(\"\".concat(getYearLabel(Date.now()),\" - Final Status: Rejected\"));}else if((item===null||item===void 0?void 0:item.workflowStatus)===\"approved\"){timeline.push(\"\".concat(getYearLabel(Date.now()),\" - Final Status: Approved\"));}setHistoryByHash(prev=>_objectSpread(_objectSpread({},prev),{},{[hash]:timeline}));}catch(error){setActionMessage((error===null||error===void 0?void 0:error.message)||\"Failed to fetch property history\");}finally{setLoadingHistoryHash(\"\");}};const searchOwnerByHash=async()=>{const value=String(searchHash||\"\").trim();if(!value){setOwnerSearchMessage(\"Enter property hash first.\");setOwnerDetails(null);return;}try{setSearchingOwner(true);setOwnerSearchMessage(\"\");setOwnerDetails(null);const response=await fetch(\"\".concat(API_BASE,\"/api/property/\").concat(encodeURIComponent(value),\"?role=\").concat(encodeURIComponent(currentRole)),{headers:{\"x-role\":currentRole}});const data=await parseJsonSafe(response);if(!response.ok){throw new Error((data===null||data===void 0?void 0:data.message)||\"Failed to search property owner\");}setOwnerDetails(data);}catch(error){setOwnerSearchMessage((error===null||error===void 0?void 0:error.message)||\"Failed to search owner by hash.\");}finally{setSearchingOwner(false);}};const copyHash=async hash=>{const value=String(hash||\"\").trim();if(!value)return;try{await navigator.clipboard.writeText(value);setActionMessage(\"Property hash copied.\");}catch(_unused8){setActionMessage(\"Copy failed. Please copy manually.\");}};return/*#__PURE__*/_jsx(\"div\",{className:\"min-h-screen bg-gradient-to-br from-slate-100 via-slate-50 to-sky-100 p-4 md:p-6\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"mx-auto max-w-7xl space-y-6\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"rounded-2xl bg-white p-6 shadow-lg ring-1 ring-slate-200\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"flex flex-col gap-3 sm:flex-row sm:items-center sm:justify-between\",children:[/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsxs(\"h1\",{className:\"text-2xl font-bold tracking-tight text-slate-900\",children:[roleLabel,\" Dashboard\"]}),/*#__PURE__*/_jsx(\"p\",{className:\"text-sm text-slate-600\",children:\"Review requests. 2 approvals -> on-chain push. 2 rejects -> rejected.\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center gap-2\",children:[/*#__PURE__*/_jsx(Link,{to:\"/user-lookup\",className:\"rounded-xl bg-sky-600 px-4 py-2 text-sm font-semibold text-white shadow hover:bg-sky-700\",children:\"User Lookup\"}),/*#__PURE__*/_jsx(Link,{to:\"/explorer\",className:\"rounded-xl bg-indigo-600 px-4 py-2 text-sm font-semibold text-white shadow hover:bg-indigo-700\",children:\"Explorer\"}),/*#__PURE__*/_jsx(\"button\",{onClick:logout,className:\"rounded-xl bg-rose-600 px-4 py-2 text-sm font-semibold text-white shadow hover:bg-rose-700\",children:\"Logout\"})]})]})}),/*#__PURE__*/_jsx(\"div\",{className:\"grid gap-6 lg:grid-cols-2\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"rounded-2xl bg-white p-6 shadow-lg ring-1 ring-slate-200\",children:[/*#__PURE__*/_jsx(\"h2\",{className:\"text-lg font-semibold text-slate-900\",children:\"Search By Property Hash\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"mt-3 flex flex-col gap-2 sm:flex-row\",children:[/*#__PURE__*/_jsx(\"input\",{type:\"text\",value:searchHash,onChange:e=>setSearchHash(e.target.value),placeholder:\"Enter property hash\",className:\"w-full rounded-xl border border-slate-300 px-3 py-2 text-xs outline-none focus:border-indigo-500\"}),/*#__PURE__*/_jsx(\"button\",{onClick:searchOwnerByHash,disabled:searchingOwner,className:\"rounded-xl px-4 py-2 text-xs font-semibold text-white \".concat(searchingOwner?\"cursor-not-allowed bg-slate-400\":\"bg-indigo-600 hover:bg-indigo-700\"),children:searchingOwner?\"Searching...\":\"Search\"})]}),ownerSearchMessage&&/*#__PURE__*/_jsx(\"p\",{className:\"mt-3 rounded-lg border border-rose-200 bg-rose-50 px-3 py-2 text-xs text-rose-700\",children:ownerSearchMessage}),ownerDetails&&/*#__PURE__*/_jsxs(\"div\",{className:\"mt-3 rounded-xl border border-slate-200 bg-slate-50 p-4\",children:[/*#__PURE__*/_jsx(\"p\",{className:\"text-xs font-semibold uppercase tracking-wide text-slate-700\",children:\"Owner Details\"}),/*#__PURE__*/_jsxs(\"p\",{className:\"mt-2 break-all text-xs text-slate-700\",children:[\"Wallet: \",/*#__PURE__*/_jsx(\"span\",{className:\"font-mono\",children:ownerDetails.walletAddress||\"-\"})]}),/*#__PURE__*/_jsxs(\"p\",{className:\"mt-1 text-xs text-slate-700\",children:[\"Name: \",ownerDetails.name||\"-\"]}),/*#__PURE__*/_jsxs(\"p\",{className:\"mt-1 text-xs text-slate-700\",children:[\"Role: \",ownerDetails.role||\"-\"]}),/*#__PURE__*/_jsxs(\"p\",{className:\"mt-1 text-xs text-slate-700\",children:[\"Aadhaar: \",ownerDetails.aadhaar||\"-\"]})]})]})}),/*#__PURE__*/_jsxs(\"div\",{className:\"rounded-2xl bg-white p-6 shadow-lg ring-1 ring-slate-200\",children:[/*#__PURE__*/_jsx(\"h2\",{className:\"text-lg font-semibold text-slate-900\",children:\"Property Queue\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"mt-3 rounded-xl border border-indigo-200 bg-indigo-50 p-3 text-xs text-indigo-900\",children:[/*#__PURE__*/_jsxs(\"p\",{className:\"font-semibold\",children:[roleLabel,\" Workflow\"]}),/*#__PURE__*/_jsx(\"p\",{className:\"mt-1\",children:\"1) Any 2 approvals from registrar/notary/local authority will push hash on-chain.\"}),/*#__PURE__*/_jsx(\"p\",{className:\"mt-1\",children:\"2) If 2 rejects are received, request becomes rejected.\"}),/*#__PURE__*/_jsx(\"p\",{className:\"mt-1\",children:\"3) Each role can submit only one decision per request.\"})]}),actionMessage&&/*#__PURE__*/_jsx(\"p\",{className:\"mt-3 rounded-lg border border-sky-200 bg-sky-50 px-3 py-2 text-sm text-sky-800\",children:actionMessage}),loading?/*#__PURE__*/_jsx(\"p\",{className:\"mt-4 text-sm text-slate-500\",children:\"Loading documents...\"}):files.length===0?/*#__PURE__*/_jsx(\"p\",{className:\"mt-4 text-sm text-slate-500\",children:\"No uploaded files found.\"}):/*#__PURE__*/_jsx(\"div\",{className:\"mt-4 overflow-x-auto rounded-xl border border-slate-200\",children:/*#__PURE__*/_jsxs(\"table\",{className:\"min-w-full divide-y divide-slate-200\",children:[/*#__PURE__*/_jsx(\"thead\",{children:/*#__PURE__*/_jsxs(\"tr\",{className:\"bg-slate-50 text-left text-xs uppercase tracking-wide text-slate-600\",children:[/*#__PURE__*/_jsx(\"th\",{className:\"px-3 py-2\",children:\"File\"}),/*#__PURE__*/_jsx(\"th\",{className:\"px-3 py-2\",children:\"Owner ID\"}),/*#__PURE__*/_jsx(\"th\",{className:\"px-3 py-2\",children:\"Hash\"}),/*#__PURE__*/_jsx(\"th\",{className:\"px-3 py-2\",children:\"Current Owner\"}),/*#__PURE__*/_jsx(\"th\",{className:\"px-3 py-2\",children:\"Workflow\"}),/*#__PURE__*/_jsx(\"th\",{className:\"px-3 py-2\",children:\"Status\"}),/*#__PURE__*/_jsx(\"th\",{className:\"px-3 py-2\",children:\"Approvals\"}),/*#__PURE__*/_jsx(\"th\",{className:\"px-3 py-2\",children:\"Rejects\"}),/*#__PURE__*/_jsx(\"th\",{className:\"px-3 py-2\",children:\"Action\"})]})}),/*#__PURE__*/_jsx(\"tbody\",{className:\"divide-y divide-slate-100 bg-white\",children:files.map(item=>{var _item$roleDecisions,_item$roleDecisions$c,_item$roleDecisions2,_item$roleDecisions2$,_item$roleDecisions3,_item$roleDecisions3$,_item$roleDecisions4,_item$roleDecisions4$;return/*#__PURE__*/_jsxs(React.Fragment,{children:[/*#__PURE__*/_jsxs(\"tr\",{className:\"hover:bg-slate-50\",children:[/*#__PURE__*/_jsx(\"td\",{className:\"px-3 py-2 text-sm text-slate-800\",children:item.filename}),/*#__PURE__*/_jsx(\"td\",{className:\"px-3 py-2\",children:/*#__PURE__*/_jsx(\"button\",{type:\"button\",onClick:()=>copyHash(item.userID),title:item.userID,className:\"text-sm text-slate-700 underline decoration-dotted underline-offset-2 hover:text-indigo-700\",children:maskValue(item.userID)})}),/*#__PURE__*/_jsx(\"td\",{className:\"px-3 py-2\",children:/*#__PURE__*/_jsx(\"button\",{type:\"button\",onClick:()=>copyHash(item.ipfshash),title:item.ipfshash,className:\"font-mono text-xs text-slate-700 underline decoration-dotted underline-offset-2 hover:text-indigo-700\",children:maskHash(item.ipfshash)})}),/*#__PURE__*/_jsx(\"td\",{className:\"px-3 py-2\",children:/*#__PURE__*/_jsx(\"button\",{type:\"button\",onClick:()=>copyHash(item.currentOwnerWallet),title:item.currentOwnerWallet||\"-\",className:\"font-mono text-xs text-slate-700 underline decoration-dotted underline-offset-2 hover:text-indigo-700\",children:maskValue(item.currentOwnerWallet)})}),/*#__PURE__*/_jsx(\"td\",{className:\"px-3 py-2 text-xs text-slate-700\",children:item.workflowStatus||\"pending\"}),/*#__PURE__*/_jsx(\"td\",{className:\"px-3 py-2 text-sm\",children:/*#__PURE__*/_jsx(\"span\",{className:item.verified||item.verifiedOnChain?\"text-emerald-700 font-medium\":item.existsOnChain===false?\"text-rose-700 font-medium\":item.existsOnChain?\"text-amber-700 font-medium\":\"text-amber-700 font-medium\",children:item.verified||item.verifiedOnChain?\"Verified\":item.workflowStatus===\"rejected\"?\"Rejected\":\"Pending Review\"})}),/*#__PURE__*/_jsx(\"td\",{className:\"px-3 py-2 text-xs text-slate-700\",children:Number(item.approvalCount||0)}),/*#__PURE__*/_jsx(\"td\",{className:\"px-3 py-2 text-xs text-slate-700\",children:Number(item.rejectCount||0)}),/*#__PURE__*/_jsx(\"td\",{className:\"px-3 py-2\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"flex flex-col gap-2\",children:[/*#__PURE__*/_jsx(\"a\",{href:\"https://gateway.pinata.cloud/ipfs/\".concat(item.ipfshash),target:\"_blank\",rel:\"noreferrer\",className:\"rounded-lg bg-indigo-600 px-3 py-1.5 text-center text-xs font-semibold text-white hover:bg-indigo-700\",children:\"View Document\"}),/*#__PURE__*/_jsx(\"button\",{onClick:()=>reviewRequest(item.ipfshash,\"approve\"),disabled:!isReviewerRole||item.workflowStatus===\"approved\"||item.workflowStatus===\"rejected\"||processingHash===item.ipfshash||Boolean(item===null||item===void 0?void 0:(_item$roleDecisions=item.roleDecisions)===null||_item$roleDecisions===void 0?void 0:(_item$roleDecisions$c=_item$roleDecisions[currentRole])===null||_item$roleDecisions$c===void 0?void 0:_item$roleDecisions$c.decision),className:\"rounded-lg px-3 py-1.5 text-xs font-semibold text-white \".concat(!isReviewerRole||item.workflowStatus===\"approved\"||item.workflowStatus===\"rejected\"||processingHash===item.ipfshash||Boolean(item===null||item===void 0?void 0:(_item$roleDecisions2=item.roleDecisions)===null||_item$roleDecisions2===void 0?void 0:(_item$roleDecisions2$=_item$roleDecisions2[currentRole])===null||_item$roleDecisions2$===void 0?void 0:_item$roleDecisions2$.decision)?\"cursor-not-allowed bg-slate-400\":\"bg-amber-600 hover:bg-amber-700\"),children:processingHash===item.ipfshash?\"Approving...\":\"Approve\"}),/*#__PURE__*/_jsx(\"button\",{onClick:()=>handleReject(item.ipfshash),disabled:!isReviewerRole||item.workflowStatus===\"approved\"||item.workflowStatus===\"rejected\"||processingHash===item.ipfshash||Boolean(item===null||item===void 0?void 0:(_item$roleDecisions3=item.roleDecisions)===null||_item$roleDecisions3===void 0?void 0:(_item$roleDecisions3$=_item$roleDecisions3[currentRole])===null||_item$roleDecisions3$===void 0?void 0:_item$roleDecisions3$.decision),className:\"rounded-lg px-3 py-1.5 text-xs font-semibold text-white \".concat(!isReviewerRole||item.workflowStatus===\"approved\"||item.workflowStatus===\"rejected\"||processingHash===item.ipfshash||Boolean(item===null||item===void 0?void 0:(_item$roleDecisions4=item.roleDecisions)===null||_item$roleDecisions4===void 0?void 0:(_item$roleDecisions4$=_item$roleDecisions4[currentRole])===null||_item$roleDecisions4$===void 0?void 0:_item$roleDecisions4$.decision)?\"cursor-not-allowed bg-slate-400\":\"bg-rose-600 hover:bg-rose-700\"),children:processingHash===item.ipfshash?\"Submitting...\":\"Reject\"}),Number(item.approvalCount||0)>=2&&item.workflowStatus===\"approved_pending_chain\"&&/*#__PURE__*/_jsx(\"button\",{onClick:()=>retryChainPush(item.ipfshash),disabled:!isReviewerRole||processingHash===item.ipfshash,className:\"rounded-lg px-3 py-1.5 text-xs font-semibold text-white \".concat(!isReviewerRole||processingHash===item.ipfshash?\"cursor-not-allowed bg-slate-400\":\"bg-emerald-600 hover:bg-emerald-700\"),children:processingHash===item.ipfshash?\"Retrying...\":\"Retry Chain Push\"}),/*#__PURE__*/_jsx(\"button\",{onClick:()=>loadHistory(item),disabled:loadingHistoryHash===item.ipfshash,className:\"rounded-lg px-3 py-1.5 text-xs font-semibold text-white \".concat(loadingHistoryHash===item.ipfshash?\"cursor-not-allowed bg-slate-400\":\"bg-sky-600 hover:bg-sky-700\"),children:loadingHistoryHash===item.ipfshash?\"Loading...\":\"View History\"})]})})]}),historyByHash[item.ipfshash]&&/*#__PURE__*/_jsx(\"tr\",{children:/*#__PURE__*/_jsxs(\"td\",{colSpan:9,className:\"bg-slate-50 px-3 py-2\",children:[/*#__PURE__*/_jsx(\"p\",{className:\"text-xs font-semibold text-slate-700\",children:\"Transfer History\"}),historyByHash[item.ipfshash].length===0?/*#__PURE__*/_jsx(\"p\",{className:\"text-xs text-slate-500\",children:\"No transfer records.\"}):/*#__PURE__*/_jsx(\"div\",{className:\"mt-1 space-y-1\",children:historyByHash[item.ipfshash].map((record,idx)=>/*#__PURE__*/_jsx(\"p\",{className:\"break-all font-mono text-[11px] text-slate-600\",children:record},\"\".concat(item.ipfshash,\"-\").concat(idx)))})]})})]},item._id);})})]})})]})]})});}export default RegistrarDashboard;","map":{"version":3,"names":["React","useEffect","useState","Link","useNavigate","pushHashOnChainWithWallet","getPropertyHistoryOnChain","getPropertyOwnerOnChain","propertyExistsOnChain","verifyPropertyOnChain","jsxs","_jsxs","jsx","_jsx","API_BASE","ZERO_ADDRESS","parseJsonSafe","response","contentType","headers","get","includes","text","Error","concat","slice","json","maskHash","hash","value","String","trim","length","maskValue","getYearLabel","date","Date","Number","isNaN","getTime","getFullYear","RegistrarDashboard","navigate","currentRole","localStorage","getItem","normalizedRole","toLowerCase","isReviewerRole","roleLabel","charAt","toUpperCase","files","setFiles","loading","setLoading","actionMessage","setActionMessage","processingHash","setProcessingHash","historyByHash","setHistoryByHash","loadingHistoryHash","setLoadingHistoryHash","searchHash","setSearchHash","searchingOwner","setSearchingOwner","ownerDetails","setOwnerDetails","ownerSearchMessage","setOwnerSearchMessage","walletLabels","setWalletLabels","logout","removeItem","replace","loadFiles","_data2","fetch","encodeURIComponent","data","_unused","ok","_data","message","rows","Array","isArray","withStatus","Promise","all","map","item","existsOnChain","verifiedOnChain","currentOwnerWallet","transferHistoryCount","ipfshash","_unused2","_unused3","_unused4","history","filter","record","from","to","_unused5","_objectSpread","Boolean","error","reviewRequest","decision","rejectionReason","arguments","undefined","_data4","method","body","JSON","stringify","role","reviewerWallet","raw","status","_data3","handleReject","reason","window","prompt","retryChainPush","txHash","resolveWalletLabel","wallet","normalized","_data$user","user","name","label","prev","_unused6","fallback","loadHistory","timeline","push","uploadedAt","userID","decisionRows","Object","entries","roleDecisions","_ref","by","at","row","sort","a","b","actor","roleLabelText","chainPushedAt","chainTxHash","chainHistory","chainRows","ts","timestamp","toLabel","fromLabel","_unused7","workflowStatus","now","searchOwnerByHash","copyHash","navigator","clipboard","writeText","_unused8","className","children","onClick","type","onChange","e","target","placeholder","disabled","walletAddress","aadhaar","_item$roleDecisions","_item$roleDecisions$c","_item$roleDecisions2","_item$roleDecisions2$","_item$roleDecisions3","_item$roleDecisions3$","_item$roleDecisions4","_item$roleDecisions4$","Fragment","filename","title","verified","approvalCount","rejectCount","href","rel","colSpan","idx","_id"],"sources":["C:/Users/ahmad/OneDrive/Desktop/evault/frontend/src/pages/RegistrarDashboard.js"],"sourcesContent":["import React, { useEffect, useState } from \"react\";\nimport { Link } from \"react-router-dom\";\nimport { useNavigate } from \"react-router-dom\";\nimport {\n  pushHashOnChainWithWallet,\n  getPropertyHistoryOnChain,\n  getPropertyOwnerOnChain,\n  propertyExistsOnChain,\n  verifyPropertyOnChain,\n} from \"../contract/propertyActions.js\";\n\r\nconst API_BASE = \"http://localhost:5000\";\r\nconst ZERO_ADDRESS = \"0x0000000000000000000000000000000000000000\";\r\n\r\nasync function parseJsonSafe(response) {\r\n  const contentType = response.headers.get(\"content-type\") || \"\";\r\n  if (!contentType.includes(\"application/json\")) {\r\n    const text = await response.text();\r\n    throw new Error(\r\n      `API did not return JSON. Response started with: ${text.slice(0, 40)}`\r\n    );\r\n  }\r\n  return response.json();\r\n}\r\n\r\nfunction maskHash(hash) {\r\n  const value = String(hash || \"\").trim();\r\n  if (!value) return \"-\";\r\n  if (value.length <= 14) return value;\r\n  return `${value.slice(0, 8)}...${value.slice(-6)}`;\r\n}\r\n\r\nfunction maskValue(value) {\n  const text = String(value || \"\").trim();\n  if (!text) return \"-\";\n  if (text.length <= 10) return text;\n  return `${text.slice(0, 4)}...${text.slice(-4)}`;\n}\n\nfunction getYearLabel(value) {\n  if (!value) return \"----\";\n  const date = new Date(value);\n  if (Number.isNaN(date.getTime())) return \"----\";\n  return String(date.getFullYear());\n}\n\r\nfunction RegistrarDashboard() {\n  const navigate = useNavigate();\n  const currentRole = String(localStorage.getItem(\"role\") || \"\").trim();\n  const normalizedRole = currentRole === \"localAuthority\" ? \"localauthority\" : currentRole.toLowerCase();\n  const isReviewerRole = [\"registrar\", \"notary\", \"localauthority\"].includes(normalizedRole);\n  const roleLabel =\n    currentRole === \"localAuthority\"\n      ? \"Local Authority\"\n      : currentRole\n      ? currentRole.charAt(0).toUpperCase() + currentRole.slice(1)\n      : \"Registrar\";\n  const [files, setFiles] = useState([]);\n  const [loading, setLoading] = useState(false);\n  const [actionMessage, setActionMessage] = useState(\"\");\n  const [processingHash, setProcessingHash] = useState(\"\");\n  const [historyByHash, setHistoryByHash] = useState({});\n  const [loadingHistoryHash, setLoadingHistoryHash] = useState(\"\");\n  const [searchHash, setSearchHash] = useState(\"\");\r\n  const [searchingOwner, setSearchingOwner] = useState(false);\n  const [ownerDetails, setOwnerDetails] = useState(null);\n  const [ownerSearchMessage, setOwnerSearchMessage] = useState(\"\");\n  const [walletLabels, setWalletLabels] = useState({});\n\r\n  const logout = () => {\r\n    localStorage.removeItem(\"user\");\r\n    localStorage.removeItem(\"role\");\r\n    navigate(\"/login\", { replace: true });\r\n  };\r\n\r\n  const loadFiles = async () => {\n    if (!isReviewerRole) {\n      setActionMessage(\"Only registrar, notary, and local authority can review requests.\");\n      setFiles([]);\n      return;\n    }\n    setLoading(true);\n    try {\n      let response = await fetch(`${API_BASE}/api/files?role=${encodeURIComponent(currentRole)}`, {\n        headers: { \"x-role\": currentRole },\n      });\n      let data;\r\n\r\n      try {\r\n        data = await parseJsonSafe(response);\r\n      } catch {\r\n        // Backward-compatible fallback to existing upload listing endpoint.\r\n        response = await fetch(`${API_BASE}/api/upload/all`);\r\n        data = await parseJsonSafe(response);\r\n      }\r\n\r\n      if (!response.ok) {\r\n        throw new Error(data?.message || \"Failed to fetch files\");\r\n      }\r\n\r\n      const rows = Array.isArray(data?.files) ? data.files : [];\r\n      const withStatus = await Promise.all(\r\n        rows.map(async (item) => {\r\n          let existsOnChain = null;\r\n          let verifiedOnChain = false;\r\n          let currentOwnerWallet = item.currentOwnerWallet || null;\r\n          let transferHistoryCount = null;\r\n\r\n          try {\r\n            existsOnChain = await propertyExistsOnChain(item.ipfshash);\r\n          } catch {\r\n            existsOnChain = null;\r\n          }\r\n\r\n          try {\r\n            verifiedOnChain = await verifyPropertyOnChain(item.ipfshash);\r\n          } catch {\r\n            verifiedOnChain = false;\r\n          }\r\n\r\n          try {\r\n            currentOwnerWallet = await getPropertyOwnerOnChain(item.ipfshash);\r\n          } catch {\r\n            // no-op\r\n          }\r\n\r\n          try {\r\n            const history = await getPropertyHistoryOnChain(item.ipfshash);\r\n            transferHistoryCount = Array.isArray(history)\r\n              ? history.filter((record) => {\r\n                  const from = String(record?.from || \"\").toLowerCase();\r\n                  const to = String(record?.to || \"\").toLowerCase();\r\n                  return from && to && from !== ZERO_ADDRESS && to !== ZERO_ADDRESS;\r\n                }).length\r\n              : 0;\r\n          } catch {\r\n            transferHistoryCount = null;\r\n          }\r\n\r\n          return {\r\n            ...item,\r\n            existsOnChain,\r\n            verifiedOnChain: Boolean(verifiedOnChain),\r\n            currentOwnerWallet,\r\n            transferHistoryCount,\r\n          };\r\n        })\r\n      );\r\n      setFiles(withStatus);\r\n    } catch (error) {\r\n      setActionMessage(\r\n        error?.message ||\r\n          \"Failed to load files. Ensure backend is running on http://localhost:5000.\"\r\n      );\r\n    } finally {\r\n      setLoading(false);\n    }\n  };\n\n  useEffect(() => {\n    loadFiles();\n  }, []); // eslint-disable-line react-hooks/exhaustive-deps\n\n  const reviewRequest = async (hash, decision, rejectionReason = \"\") => {\n    try {\n      setProcessingHash(hash);\n      setActionMessage(\n        decision === \"approve\" ? \"Submitting approval...\" : \"Submitting rejection...\"\n      );\n\n      const response = await fetch(`${API_BASE}/api/files/review`, {\n        method: \"PATCH\",\n        headers: { \"Content-Type\": \"application/json\", \"x-role\": currentRole },\n        body: JSON.stringify({\n          hash,\n          role: currentRole,\n          reviewerWallet: localStorage.getItem(\"walletAddress\") || null,\n          decision,\n          rejectionReason: rejectionReason || null,\n        }),\n      });\n      const contentType = response.headers.get(\"content-type\") || \"\";\n      let data = null;\n      if (contentType.includes(\"application/json\")) {\n        data = await response.json();\n      } else {\n        const raw = await response.text();\n        if (response.status === 404) {\n          throw new Error(\n            \"Review API not found. Restart backend so /api/files/review route is loaded.\"\n          );\n        }\n        throw new Error(\n          `Review API returned non-JSON response (status ${response.status}). Response starts with: ${raw\n            .replace(/\\s+/g, \" \")\n            .slice(0, 80)}`\n        );\n      }\n      if (!response.ok) {\n        throw new Error(data?.message || \"Failed to submit review\");\n      }\n\n      setActionMessage(data?.message || \"Review submitted.\");\n      await loadFiles();\n    } catch (error) {\n      setActionMessage(error?.message || \"Review failed\");\n    } finally {\n      setProcessingHash(\"\");\n    }\n  };\n\n  const handleReject = (hash) => {\n    const reason = window.prompt(\"Enter rejection reason (mandatory):\", \"\");\n    if (!reason || !String(reason).trim()) {\n      setActionMessage(\"Rejection reason is required.\");\n      return;\n    }\n    reviewRequest(hash, \"reject\", String(reason).trim());\n  };\n\n  const retryChainPush = async (hash) => {\n    try {\n      setProcessingHash(hash);\n      setActionMessage(\"Waiting for MetaMask confirmation...\");\n      const txHash = await pushHashOnChainWithWallet(hash);\n\n      setActionMessage(\"MetaMask tx confirmed. Syncing backend status...\");\n      const response = await fetch(`${API_BASE}/api/files/confirm-chain-push`, {\n        method: \"PATCH\",\n        headers: { \"Content-Type\": \"application/json\", \"x-role\": currentRole },\n        body: JSON.stringify({ hash, role: currentRole, txHash }),\n      });\n      const data = await parseJsonSafe(response);\n      if (!response.ok) {\n        throw new Error(data?.message || \"Retry failed\");\n      }\n      setActionMessage(\n        `${data?.message || \"Blockchain push successful.\"}${\n          txHash ? ` Tx: ${txHash}` : \"\"\n        }`\n      );\n      await loadFiles();\n    } catch (error) {\n      setActionMessage(error?.message || \"Retry failed\");\n    } finally {\n      setProcessingHash(\"\");\n    }\n  };\n\n  const resolveWalletLabel = async (wallet) => {\n    const normalized = String(wallet || \"\").trim().toLowerCase();\n    if (!normalized || normalized === ZERO_ADDRESS) return \"System\";\n    if (walletLabels[normalized]) return walletLabels[normalized];\n\n    try {\n      const response = await fetch(\n        `${API_BASE}/api/auth/user-by-wallet/${encodeURIComponent(normalized)}?role=${encodeURIComponent(currentRole)}`,\n        { headers: { \"x-role\": currentRole } }\n      );\n      const data = await parseJsonSafe(response);\n      if (response.ok && data?.user?.name) {\n        const label = `${data.user.name} (${maskValue(normalized)})`;\n        setWalletLabels((prev) => ({ ...prev, [normalized]: label }));\n        return label;\n      }\n    } catch {\n      // fallback below\n    }\n\n    const fallback = maskValue(normalized);\n    setWalletLabels((prev) => ({ ...prev, [normalized]: fallback }));\n    return fallback;\n  };\n\n  const loadHistory = async (item) => {\n    const hash = String(item?.ipfshash || \"\").trim();\n    if (!hash) return;\n\n    try {\n      setLoadingHistoryHash(hash);\n      const timeline = [];\n\n      timeline.push(\n        `${getYearLabel(item?.uploadedAt)} - Requested (${String(item?.userID || \"Citizen\")})`\n      );\n\n      const decisionRows = Object.entries(item?.roleDecisions || {})\n        .map(([role, value]) => ({\n          role,\n          decision: value?.decision || null,\n          reason: value?.reason || null,\n          by: value?.by || null,\n          at: value?.at || null,\n        }))\n        .filter((row) => row.decision && row.at)\n        .sort((a, b) => new Date(a.at).getTime() - new Date(b.at).getTime());\n\n      for (const row of decisionRows) {\n        const actor = row.by ? await resolveWalletLabel(row.by) : row.role;\n        const roleLabelText =\n          row.role === \"localAuthority\"\n            ? \"Local Authority\"\n            : row.role.charAt(0).toUpperCase() + row.role.slice(1);\n        if (row.decision === \"approve\") {\n          timeline.push(`${getYearLabel(row.at)} - Approved by ${roleLabelText} (${actor})`);\n        } else {\n          timeline.push(\n            `${getYearLabel(row.at)} - Rejected by ${roleLabelText} (${actor})${\n              row.reason ? ` | Reason: ${row.reason}` : \"\"\n            }`\n          );\n        }\n      }\n\n      if (item?.chainPushedAt) {\n        timeline.push(\n          `${getYearLabel(item.chainPushedAt)} - Registered on Blockchain${\n            item.chainTxHash ? ` (Tx: ${maskValue(item.chainTxHash)})` : \"\"\n          }`\n        );\n      }\n\n      try {\n        const chainHistory = await getPropertyHistoryOnChain(hash);\n        const chainRows = Array.isArray(chainHistory) ? chainHistory : [];\n        for (const record of chainRows) {\n          const from = String(record?.from || \"\").toLowerCase();\n          const to = String(record?.to || \"\").toLowerCase();\n          const ts = Number(record?.timestamp || 0);\n          if (!to || to === ZERO_ADDRESS) continue;\n          const toLabel = await resolveWalletLabel(to);\n          if (!from || from === ZERO_ADDRESS) {\n            timeline.push(\n              `${getYearLabel(ts ? ts * 1000 : null)} - Registered (${toLabel})`\n            );\n          } else {\n            const fromLabel = await resolveWalletLabel(from);\n            timeline.push(\n              `${getYearLabel(ts ? ts * 1000 : null)} - Transferred (${fromLabel} -> ${toLabel})`\n            );\n          }\n        }\n      } catch {\n        // chain history optional\n      }\n\n      if (item?.workflowStatus === \"rejected\") {\n        timeline.push(`${getYearLabel(Date.now())} - Final Status: Rejected`);\n      } else if (item?.workflowStatus === \"approved\") {\n        timeline.push(`${getYearLabel(Date.now())} - Final Status: Approved`);\n      }\n\n      setHistoryByHash((prev) => ({ ...prev, [hash]: timeline }));\n    } catch (error) {\n      setActionMessage(error?.message || \"Failed to fetch property history\");\n    } finally {\n      setLoadingHistoryHash(\"\");\n    }\r\n  };\r\n\r\n  const searchOwnerByHash = async () => {\r\n    const value = String(searchHash || \"\").trim();\r\n    if (!value) {\r\n      setOwnerSearchMessage(\"Enter property hash first.\");\r\n      setOwnerDetails(null);\r\n      return;\r\n    }\r\n\r\n    try {\r\n      setSearchingOwner(true);\r\n      setOwnerSearchMessage(\"\");\r\n      setOwnerDetails(null);\r\n\r\n      const response = await fetch(\n        `${API_BASE}/api/property/${encodeURIComponent(value)}?role=${encodeURIComponent(currentRole)}`,\n        { headers: { \"x-role\": currentRole } }\n      );\n      const data = await parseJsonSafe(response);\r\n      if (!response.ok) {\r\n        throw new Error(data?.message || \"Failed to search property owner\");\r\n      }\r\n\r\n      setOwnerDetails(data);\r\n    } catch (error) {\r\n      setOwnerSearchMessage(error?.message || \"Failed to search owner by hash.\");\r\n    } finally {\r\n      setSearchingOwner(false);\r\n    }\r\n  };\r\n\r\n  const copyHash = async (hash) => {\r\n    const value = String(hash || \"\").trim();\r\n    if (!value) return;\r\n    try {\r\n      await navigator.clipboard.writeText(value);\r\n      setActionMessage(\"Property hash copied.\");\r\n    } catch {\r\n      setActionMessage(\"Copy failed. Please copy manually.\");\r\n    }\r\n  };\r\n\r\n  return (\r\n    <div className=\"min-h-screen bg-gradient-to-br from-slate-100 via-slate-50 to-sky-100 p-4 md:p-6\">\r\n      <div className=\"mx-auto max-w-7xl space-y-6\">\r\n        <div className=\"rounded-2xl bg-white p-6 shadow-lg ring-1 ring-slate-200\">\r\n          <div className=\"flex flex-col gap-3 sm:flex-row sm:items-center sm:justify-between\">\r\n            <div>\n              <h1 className=\"text-2xl font-bold tracking-tight text-slate-900\">{roleLabel} Dashboard</h1>\n              <p className=\"text-sm text-slate-600\">\n                Review requests. 2 approvals -> on-chain push. 2 rejects -> rejected.\n              </p>\n            </div>\r\n            <div className=\"flex items-center gap-2\">\r\n              <Link\r\n                to=\"/user-lookup\"\r\n                className=\"rounded-xl bg-sky-600 px-4 py-2 text-sm font-semibold text-white shadow hover:bg-sky-700\"\r\n              >\r\n                User Lookup\r\n              </Link>\r\n              <Link\r\n                to=\"/explorer\"\r\n                className=\"rounded-xl bg-indigo-600 px-4 py-2 text-sm font-semibold text-white shadow hover:bg-indigo-700\"\r\n              >\r\n                Explorer\r\n              </Link>\r\n              <button\r\n                onClick={logout}\r\n                className=\"rounded-xl bg-rose-600 px-4 py-2 text-sm font-semibold text-white shadow hover:bg-rose-700\"\r\n              >\r\n                Logout\r\n              </button>\r\n            </div>\r\n          </div>\r\n        </div>\r\n\r\n        <div className=\"grid gap-6 lg:grid-cols-2\">\r\n\r\n\r\n          <div className=\"rounded-2xl bg-white p-6 shadow-lg ring-1 ring-slate-200\">\r\n            <h2 className=\"text-lg font-semibold text-slate-900\">Search By Property Hash</h2>\r\n            <div className=\"mt-3 flex flex-col gap-2 sm:flex-row\">\r\n              <input\r\n                type=\"text\"\r\n                value={searchHash}\r\n                onChange={(e) => setSearchHash(e.target.value)}\r\n                placeholder=\"Enter property hash\"\r\n                className=\"w-full rounded-xl border border-slate-300 px-3 py-2 text-xs outline-none focus:border-indigo-500\"\r\n              />\r\n              <button\r\n                onClick={searchOwnerByHash}\r\n                disabled={searchingOwner}\r\n                className={`rounded-xl px-4 py-2 text-xs font-semibold text-white ${\r\n                  searchingOwner ? \"cursor-not-allowed bg-slate-400\" : \"bg-indigo-600 hover:bg-indigo-700\"\r\n                }`}\r\n              >\r\n                {searchingOwner ? \"Searching...\" : \"Search\"}\r\n              </button>\r\n            </div>\r\n            {ownerSearchMessage && (\r\n              <p className=\"mt-3 rounded-lg border border-rose-200 bg-rose-50 px-3 py-2 text-xs text-rose-700\">\r\n                {ownerSearchMessage}\r\n              </p>\r\n            )}\r\n            {ownerDetails && (\r\n              <div className=\"mt-3 rounded-xl border border-slate-200 bg-slate-50 p-4\">\r\n                <p className=\"text-xs font-semibold uppercase tracking-wide text-slate-700\">Owner Details</p>\r\n                <p className=\"mt-2 break-all text-xs text-slate-700\">\r\n                  Wallet: <span className=\"font-mono\">{ownerDetails.walletAddress || \"-\"}</span>\r\n                </p>\r\n                <p className=\"mt-1 text-xs text-slate-700\">Name: {ownerDetails.name || \"-\"}</p>\r\n                <p className=\"mt-1 text-xs text-slate-700\">Role: {ownerDetails.role || \"-\"}</p>\r\n                <p className=\"mt-1 text-xs text-slate-700\">Aadhaar: {ownerDetails.aadhaar || \"-\"}</p>\r\n              </div>\r\n            )}\r\n          </div>\r\n        </div>\r\n\r\n        <div className=\"rounded-2xl bg-white p-6 shadow-lg ring-1 ring-slate-200\">\r\n          <h2 className=\"text-lg font-semibold text-slate-900\">Property Queue</h2>\r\n          <div className=\"mt-3 rounded-xl border border-indigo-200 bg-indigo-50 p-3 text-xs text-indigo-900\">\r\n            <p className=\"font-semibold\">{roleLabel} Workflow</p>\n            <p className=\"mt-1\">\n              1) Any 2 approvals from registrar/notary/local authority will push hash on-chain.\n            </p>\n            <p className=\"mt-1\">\n              2) If 2 rejects are received, request becomes rejected.\n            </p>\n            <p className=\"mt-1\">\n              3) Each role can submit only one decision per request.\n            </p>\n          </div>\r\n          {actionMessage && (\r\n            <p className=\"mt-3 rounded-lg border border-sky-200 bg-sky-50 px-3 py-2 text-sm text-sky-800\">\r\n              {actionMessage}\r\n            </p>\r\n          )}\r\n          {loading ? (\r\n            <p className=\"mt-4 text-sm text-slate-500\">Loading documents...</p>\r\n          ) : files.length === 0 ? (\r\n            <p className=\"mt-4 text-sm text-slate-500\">No uploaded files found.</p>\r\n          ) : (\r\n            <div className=\"mt-4 overflow-x-auto rounded-xl border border-slate-200\">\r\n              <table className=\"min-w-full divide-y divide-slate-200\">\r\n                <thead>\r\n                  <tr className=\"bg-slate-50 text-left text-xs uppercase tracking-wide text-slate-600\">\r\n                    <th className=\"px-3 py-2\">File</th>\r\n                    <th className=\"px-3 py-2\">Owner ID</th>\r\n                    <th className=\"px-3 py-2\">Hash</th>\r\n                    <th className=\"px-3 py-2\">Current Owner</th>\r\n                     <th className=\"px-3 py-2\">Workflow</th>\n                     <th className=\"px-3 py-2\">Status</th>\n                     <th className=\"px-3 py-2\">Approvals</th>\n                     <th className=\"px-3 py-2\">Rejects</th>\n                     <th className=\"px-3 py-2\">Action</th>\n                  </tr>\r\n                </thead>\r\n                <tbody className=\"divide-y divide-slate-100 bg-white\">\r\n                  {files.map((item) => (\r\n                    <React.Fragment key={item._id}>\r\n                    <tr className=\"hover:bg-slate-50\">\r\n                      <td className=\"px-3 py-2 text-sm text-slate-800\">{item.filename}</td>\r\n                      <td className=\"px-3 py-2\">\r\n                        <button\r\n                          type=\"button\"\r\n                          onClick={() => copyHash(item.userID)}\r\n                          title={item.userID}\r\n                          className=\"text-sm text-slate-700 underline decoration-dotted underline-offset-2 hover:text-indigo-700\"\r\n                        >\r\n                          {maskValue(item.userID)}\r\n                        </button>\r\n                      </td>\r\n                      <td className=\"px-3 py-2\">\r\n                        <button\r\n                          type=\"button\"\r\n                          onClick={() => copyHash(item.ipfshash)}\r\n                          title={item.ipfshash}\r\n                          className=\"font-mono text-xs text-slate-700 underline decoration-dotted underline-offset-2 hover:text-indigo-700\"\r\n                        >\r\n                          {maskHash(item.ipfshash)}\r\n                        </button>\r\n                      </td>\r\n                      <td className=\"px-3 py-2\">\r\n                        <button\r\n                          type=\"button\"\r\n                          onClick={() => copyHash(item.currentOwnerWallet)}\r\n                          title={item.currentOwnerWallet || \"-\"}\r\n                          className=\"font-mono text-xs text-slate-700 underline decoration-dotted underline-offset-2 hover:text-indigo-700\"\r\n                        >\r\n                          {maskValue(item.currentOwnerWallet)}\r\n                        </button>\r\n                      </td>\r\n                      <td className=\"px-3 py-2 text-xs text-slate-700\">\n                        {item.workflowStatus || \"pending\"}\n                      </td>\n                      <td className=\"px-3 py-2 text-sm\">\r\n                        <span\r\n                          className={\r\n                            item.verified || item.verifiedOnChain\r\n                              ? \"text-emerald-700 font-medium\"\r\n                              : item.existsOnChain === false\r\n                              ? \"text-rose-700 font-medium\"\r\n                              : item.existsOnChain\r\n                              ? \"text-amber-700 font-medium\"\r\n                              : \"text-amber-700 font-medium\"\r\n                          }\r\n                        >\r\n                          {item.verified || item.verifiedOnChain\r\n                            ? \"Verified\"\n                            : item.workflowStatus === \"rejected\"\n                            ? \"Rejected\"\n                            : \"Pending Review\"}\n                        </span>\n                      </td>\n                      <td className=\"px-3 py-2 text-xs text-slate-700\">{Number(item.approvalCount || 0)}</td>\n                      <td className=\"px-3 py-2 text-xs text-slate-700\">{Number(item.rejectCount || 0)}</td>\n                      <td className=\"px-3 py-2\">\n                        <div className=\"flex flex-col gap-2\">\n                          <a\r\n                            href={`https://gateway.pinata.cloud/ipfs/${item.ipfshash}`}\r\n                            target=\"_blank\"\r\n                            rel=\"noreferrer\"\r\n                            className=\"rounded-lg bg-indigo-600 px-3 py-1.5 text-center text-xs font-semibold text-white hover:bg-indigo-700\"\r\n                          >\r\n                            View Document\r\n                          </a>\r\n                          <button\r\n                            onClick={() => reviewRequest(item.ipfshash, \"approve\")}\n                            disabled={\n                              !isReviewerRole ||\n                              item.workflowStatus === \"approved\" ||\n                              item.workflowStatus === \"rejected\" ||\n                              processingHash === item.ipfshash ||\n                              Boolean(item?.roleDecisions?.[currentRole]?.decision)\n                            }\n                            className={`rounded-lg px-3 py-1.5 text-xs font-semibold text-white ${\n                              !isReviewerRole ||\n                              item.workflowStatus === \"approved\" ||\n                              item.workflowStatus === \"rejected\" ||\n                              processingHash === item.ipfshash ||\n                              Boolean(item?.roleDecisions?.[currentRole]?.decision)\n                                ? \"cursor-not-allowed bg-slate-400\"\n                                : \"bg-amber-600 hover:bg-amber-700\"\n                            }`}\n                          >\n                            {processingHash === item.ipfshash ? \"Approving...\" : \"Approve\"}\n                          </button>\n                          <button\n                            onClick={() => handleReject(item.ipfshash)}\n                            disabled={\n                              !isReviewerRole ||\n                              item.workflowStatus === \"approved\" ||\n                              item.workflowStatus === \"rejected\" ||\n                              processingHash === item.ipfshash ||\n                              Boolean(item?.roleDecisions?.[currentRole]?.decision)\n                            }\n                            className={`rounded-lg px-3 py-1.5 text-xs font-semibold text-white ${\n                              !isReviewerRole ||\n                              item.workflowStatus === \"approved\" ||\n                              item.workflowStatus === \"rejected\" ||\n                              processingHash === item.ipfshash ||\n                              Boolean(item?.roleDecisions?.[currentRole]?.decision)\n                                ? \"cursor-not-allowed bg-slate-400\"\n                                : \"bg-rose-600 hover:bg-rose-700\"\n                            }`}\n                          >\n                            {processingHash === item.ipfshash ? \"Submitting...\" : \"Reject\"}\n                          </button>\n                          {Number(item.approvalCount || 0) >= 2 &&\n                            item.workflowStatus === \"approved_pending_chain\" && (\n                              <button\n                                onClick={() => retryChainPush(item.ipfshash)}\n                                disabled={!isReviewerRole || processingHash === item.ipfshash}\n                                className={`rounded-lg px-3 py-1.5 text-xs font-semibold text-white ${\n                                  !isReviewerRole || processingHash === item.ipfshash\n                                    ? \"cursor-not-allowed bg-slate-400\"\n                                    : \"bg-emerald-600 hover:bg-emerald-700\"\n                                }`}\n                              >\n                                {processingHash === item.ipfshash ? \"Retrying...\" : \"Retry Chain Push\"}\n                              </button>\n                            )}\n                          <button\n                            onClick={() => loadHistory(item)}\n                            disabled={loadingHistoryHash === item.ipfshash}\n                            className={`rounded-lg px-3 py-1.5 text-xs font-semibold text-white ${\n                              loadingHistoryHash === item.ipfshash\n                                ? \"cursor-not-allowed bg-slate-400\"\r\n                                : \"bg-sky-600 hover:bg-sky-700\"\r\n                            }`}\r\n                          >\r\n                            {loadingHistoryHash === item.ipfshash ? \"Loading...\" : \"View History\"}\r\n                          </button>\r\n                        </div>\r\n                      </td>\r\n                    </tr>\r\n                    {historyByHash[item.ipfshash] && (\r\n                      <tr>\r\n                        <td colSpan={9} className=\"bg-slate-50 px-3 py-2\">\n                          <p className=\"text-xs font-semibold text-slate-700\">Transfer History</p>\r\n                          {historyByHash[item.ipfshash].length === 0 ? (\r\n                            <p className=\"text-xs text-slate-500\">No transfer records.</p>\r\n                          ) : (\r\n                            <div className=\"mt-1 space-y-1\">\r\n                              {historyByHash[item.ipfshash].map((record, idx) => (\n                                <p key={`${item.ipfshash}-${idx}`} className=\"break-all font-mono text-[11px] text-slate-600\">\n                                  {record}\n                                </p>\n                              ))}\n                            </div>\n                          )}\r\n                        </td>\r\n                      </tr>\r\n                    )}\r\n                    </React.Fragment>\r\n                  ))}\r\n                </tbody>\r\n              </table>\r\n            </div>\r\n          )}\r\n        </div>\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\n\r\nexport default RegistrarDashboard;\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}