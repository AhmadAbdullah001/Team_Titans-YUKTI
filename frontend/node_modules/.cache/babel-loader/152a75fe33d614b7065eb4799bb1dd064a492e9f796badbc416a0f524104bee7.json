{"ast":null,"code":"import { ethers } from \"ethers\";\nimport { EVAULT_ADDRESS } from \"./config.js\";\nimport { EVAULT_ABI } from \"./evaultAbi.js\";\nconst WALLET_KEY = \"evault_wallet\";\nfunction ensureWallet() {\n  if (!window.ethereum) {\n    throw new Error(\"MetaMask is required.\");\n  }\n}\nexport async function connectWallet() {\n  ensureWallet();\n  const provider = new ethers.BrowserProvider(window.ethereum);\n  const accounts = await provider.send(\"eth_requestAccounts\", []);\n  const network = await provider.getNetwork();\n  const wallet = {\n    address: accounts[0],\n    chainId: network.chainId.toString()\n  };\n  localStorage.setItem(WALLET_KEY, JSON.stringify(wallet));\n  return wallet;\n}\nexport function getSavedWallet() {\n  try {\n    return JSON.parse(localStorage.getItem(WALLET_KEY) || \"null\");\n  } catch {\n    return null;\n  }\n}\nexport async function getProvider() {\n  ensureWallet();\n  return new ethers.BrowserProvider(window.ethereum);\n}\nexport async function getSigner() {\n  const provider = await getProvider();\n  return provider.getSigner();\n}\nexport async function getEVaultContract(withSigner = false) {\n  if (!EVAULT_ADDRESS || EVAULT_ADDRESS === ethers.ZeroAddress) {\n    throw new Error(\"Set REACT_APP_EVAULT_ADDRESS in frontend/.env\");\n  }\n  if (withSigner) {\n    const signer = await getSigner();\n    return new ethers.Contract(EVAULT_ADDRESS, EVAULT_ABI, signer);\n  }\n  const provider = await getProvider();\n  return new ethers.Contract(EVAULT_ADDRESS, EVAULT_ABI, provider);\n}\nexport function shortAddress(address) {\n  if (!address) return \"\";\n  const v = String(address);\n  return `${v.slice(0, 6)}...${v.slice(-4)}`;\n}","map":{"version":3,"names":["ethers","EVAULT_ADDRESS","EVAULT_ABI","WALLET_KEY","ensureWallet","window","ethereum","Error","connectWallet","provider","BrowserProvider","accounts","send","network","getNetwork","wallet","address","chainId","toString","localStorage","setItem","JSON","stringify","getSavedWallet","parse","getItem","getProvider","getSigner","getEVaultContract","withSigner","ZeroAddress","signer","Contract","shortAddress","v","String","slice"],"sources":["C:/Users/ahmad/OneDrive/Desktop/evault/frontend/src/utils/web3.js"],"sourcesContent":["import { ethers } from \"ethers\";\nimport { EVAULT_ADDRESS } from \"./config.js\";\nimport { EVAULT_ABI } from \"./evaultAbi.js\";\n\nconst WALLET_KEY = \"evault_wallet\";\n\nfunction ensureWallet() {\n  if (!window.ethereum) {\n    throw new Error(\"MetaMask is required.\");\n  }\n}\n\nexport async function connectWallet() {\n  ensureWallet();\n  const provider = new ethers.BrowserProvider(window.ethereum);\n  const accounts = await provider.send(\"eth_requestAccounts\", []);\n  const network = await provider.getNetwork();\n  const wallet = {\n    address: accounts[0],\n    chainId: network.chainId.toString(),\n  };\n  localStorage.setItem(WALLET_KEY, JSON.stringify(wallet));\n  return wallet;\n}\n\nexport function getSavedWallet() {\n  try {\n    return JSON.parse(localStorage.getItem(WALLET_KEY) || \"null\");\n  } catch {\n    return null;\n  }\n}\n\nexport async function getProvider() {\n  ensureWallet();\n  return new ethers.BrowserProvider(window.ethereum);\n}\n\nexport async function getSigner() {\n  const provider = await getProvider();\n  return provider.getSigner();\n}\n\nexport async function getEVaultContract(withSigner = false) {\n  if (!EVAULT_ADDRESS || EVAULT_ADDRESS === ethers.ZeroAddress) {\n    throw new Error(\"Set REACT_APP_EVAULT_ADDRESS in frontend/.env\");\n  }\n  if (withSigner) {\n    const signer = await getSigner();\n    return new ethers.Contract(EVAULT_ADDRESS, EVAULT_ABI, signer);\n  }\n  const provider = await getProvider();\n  return new ethers.Contract(EVAULT_ADDRESS, EVAULT_ABI, provider);\n}\n\nexport function shortAddress(address) {\n  if (!address) return \"\";\n  const v = String(address);\n  return `${v.slice(0, 6)}...${v.slice(-4)}`;\n}\n"],"mappings":"AAAA,SAASA,MAAM,QAAQ,QAAQ;AAC/B,SAASC,cAAc,QAAQ,aAAa;AAC5C,SAASC,UAAU,QAAQ,gBAAgB;AAE3C,MAAMC,UAAU,GAAG,eAAe;AAElC,SAASC,YAAYA,CAAA,EAAG;EACtB,IAAI,CAACC,MAAM,CAACC,QAAQ,EAAE;IACpB,MAAM,IAAIC,KAAK,CAAC,uBAAuB,CAAC;EAC1C;AACF;AAEA,OAAO,eAAeC,aAAaA,CAAA,EAAG;EACpCJ,YAAY,CAAC,CAAC;EACd,MAAMK,QAAQ,GAAG,IAAIT,MAAM,CAACU,eAAe,CAACL,MAAM,CAACC,QAAQ,CAAC;EAC5D,MAAMK,QAAQ,GAAG,MAAMF,QAAQ,CAACG,IAAI,CAAC,qBAAqB,EAAE,EAAE,CAAC;EAC/D,MAAMC,OAAO,GAAG,MAAMJ,QAAQ,CAACK,UAAU,CAAC,CAAC;EAC3C,MAAMC,MAAM,GAAG;IACbC,OAAO,EAAEL,QAAQ,CAAC,CAAC,CAAC;IACpBM,OAAO,EAAEJ,OAAO,CAACI,OAAO,CAACC,QAAQ,CAAC;EACpC,CAAC;EACDC,YAAY,CAACC,OAAO,CAACjB,UAAU,EAAEkB,IAAI,CAACC,SAAS,CAACP,MAAM,CAAC,CAAC;EACxD,OAAOA,MAAM;AACf;AAEA,OAAO,SAASQ,cAAcA,CAAA,EAAG;EAC/B,IAAI;IACF,OAAOF,IAAI,CAACG,KAAK,CAACL,YAAY,CAACM,OAAO,CAACtB,UAAU,CAAC,IAAI,MAAM,CAAC;EAC/D,CAAC,CAAC,MAAM;IACN,OAAO,IAAI;EACb;AACF;AAEA,OAAO,eAAeuB,WAAWA,CAAA,EAAG;EAClCtB,YAAY,CAAC,CAAC;EACd,OAAO,IAAIJ,MAAM,CAACU,eAAe,CAACL,MAAM,CAACC,QAAQ,CAAC;AACpD;AAEA,OAAO,eAAeqB,SAASA,CAAA,EAAG;EAChC,MAAMlB,QAAQ,GAAG,MAAMiB,WAAW,CAAC,CAAC;EACpC,OAAOjB,QAAQ,CAACkB,SAAS,CAAC,CAAC;AAC7B;AAEA,OAAO,eAAeC,iBAAiBA,CAACC,UAAU,GAAG,KAAK,EAAE;EAC1D,IAAI,CAAC5B,cAAc,IAAIA,cAAc,KAAKD,MAAM,CAAC8B,WAAW,EAAE;IAC5D,MAAM,IAAIvB,KAAK,CAAC,+CAA+C,CAAC;EAClE;EACA,IAAIsB,UAAU,EAAE;IACd,MAAME,MAAM,GAAG,MAAMJ,SAAS,CAAC,CAAC;IAChC,OAAO,IAAI3B,MAAM,CAACgC,QAAQ,CAAC/B,cAAc,EAAEC,UAAU,EAAE6B,MAAM,CAAC;EAChE;EACA,MAAMtB,QAAQ,GAAG,MAAMiB,WAAW,CAAC,CAAC;EACpC,OAAO,IAAI1B,MAAM,CAACgC,QAAQ,CAAC/B,cAAc,EAAEC,UAAU,EAAEO,QAAQ,CAAC;AAClE;AAEA,OAAO,SAASwB,YAAYA,CAACjB,OAAO,EAAE;EACpC,IAAI,CAACA,OAAO,EAAE,OAAO,EAAE;EACvB,MAAMkB,CAAC,GAAGC,MAAM,CAACnB,OAAO,CAAC;EACzB,OAAO,GAAGkB,CAAC,CAACE,KAAK,CAAC,CAAC,EAAE,CAAC,CAAC,MAAMF,CAAC,CAACE,KAAK,CAAC,CAAC,CAAC,CAAC,EAAE;AAC5C","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}