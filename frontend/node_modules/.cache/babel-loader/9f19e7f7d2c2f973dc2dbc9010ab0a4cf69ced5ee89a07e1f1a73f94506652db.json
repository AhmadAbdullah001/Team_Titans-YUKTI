{"ast":null,"code":"import{ethers}from\"ethers\";import abi from\"./abi.json\";import{HARDHAT_LOCALHOST_CHAIN_ID,contractAddress,LAND_REGISTRY_VERSION}from\"./contractconfig.js\";const LOCAL_RPC_URL=\"http://127.0.0.1:8545\";let isContractCodeValidated=false;export function getLocalReadProvider(){return new ethers.JsonRpcProvider(LOCAL_RPC_URL);}export async function getBrowserProvider(){if(!window.ethereum){throw new Error(\"MetaMask not installed\");}return new ethers.BrowserProvider(window.ethereum);}export async function ensureWalletConnected(provider){const accounts=await provider.send(\"eth_accounts\",[]);if(accounts&&accounts.length>0){return accounts;}try{return await provider.send(\"eth_requestAccounts\",[]);}catch(error){if((error===null||error===void 0?void 0:error.code)===-32002){throw new Error(\"MetaMask request already pending. Open MetaMask and approve first.\");}throw error;}}export async function ensureCorrectNetwork(provider){const network=await provider.getNetwork();if(Number(network.chainId)===HARDHAT_LOCALHOST_CHAIN_ID){return;}const targetChainHex=\"0x\".concat(HARDHAT_LOCALHOST_CHAIN_ID.toString(16));try{await provider.send(\"wallet_switchEthereumChain\",[{chainId:targetChainHex}]);}catch(error){if((error===null||error===void 0?void 0:error.code)===4902){await provider.send(\"wallet_addEthereumChain\",[{chainId:targetChainHex,chainName:\"Hardhat Localhost\",rpcUrls:[LOCAL_RPC_URL],nativeCurrency:{name:\"ETH\",symbol:\"ETH\",decimals:18}}]);return;}throw new Error(\"Wrong network in MetaMask. Switch to Hardhat Localhost (chainId 31337).\");}}export async function ensureContractCode(provider){if(!contractAddress||contractAddress===\"0x0000000000000000000000000000000000000000\"){throw new Error(\"Contract address is not configured. Run blockchain deploy first.\");}if(isContractCodeValidated){return;}let code=\"0x\";try{code=await provider.getCode(contractAddress);}catch(error){const rpcMessage=String((error===null||error===void 0?void 0:error.message)||\"\");const isRateLimit=(error===null||error===void 0?void 0:error.code)===-32002||rpcMessage.includes(\"too many errors\")||rpcMessage.includes(\"retrying in\");if(!isRateLimit){throw error;}// Fallback to local Hardhat RPC when wallet RPC is throttled.\ncode=await getLocalReadProvider().getCode(contractAddress);}if(!code||code===\"0x\"){throw new Error(\"No contract found at \".concat(contractAddress,\". Redeploy and update config.\"));}isContractCodeValidated=true;}export function getReadOnlyContract(provider){return new ethers.Contract(contractAddress,abi,provider);}export function getWriteContract(signer){return new ethers.Contract(contractAddress,abi,signer);}export function getContractRuntimeConfig(){return{contractAddress,chainId:HARDHAT_LOCALHOST_CHAIN_ID,version:LAND_REGISTRY_VERSION||\"legacy\"};}","map":{"version":3,"names":["ethers","abi","HARDHAT_LOCALHOST_CHAIN_ID","contractAddress","LAND_REGISTRY_VERSION","LOCAL_RPC_URL","isContractCodeValidated","getLocalReadProvider","JsonRpcProvider","getBrowserProvider","window","ethereum","Error","BrowserProvider","ensureWalletConnected","provider","accounts","send","length","error","code","ensureCorrectNetwork","network","getNetwork","Number","chainId","targetChainHex","concat","toString","chainName","rpcUrls","nativeCurrency","name","symbol","decimals","ensureContractCode","getCode","rpcMessage","String","message","isRateLimit","includes","getReadOnlyContract","Contract","getWriteContract","signer","getContractRuntimeConfig","version"],"sources":["C:/Users/ahmad/OneDrive/Desktop/evault/frontend/src/contract/eth.js"],"sourcesContent":["import { ethers } from \"ethers\";\nimport abi from \"./abi.json\";\nimport {\n  HARDHAT_LOCALHOST_CHAIN_ID,\n  contractAddress,\n  LAND_REGISTRY_VERSION,\n} from \"./contractconfig.js\";\n\nconst LOCAL_RPC_URL = \"http://127.0.0.1:8545\";\nlet isContractCodeValidated = false;\n\nexport function getLocalReadProvider() {\n  return new ethers.JsonRpcProvider(LOCAL_RPC_URL);\n}\n\nexport async function getBrowserProvider() {\n  if (!window.ethereum) {\n    throw new Error(\"MetaMask not installed\");\n  }\n  return new ethers.BrowserProvider(window.ethereum);\n}\n\nexport async function ensureWalletConnected(provider) {\n  const accounts = await provider.send(\"eth_accounts\", []);\n  if (accounts && accounts.length > 0) {\n    return accounts;\n  }\n\n  try {\n    return await provider.send(\"eth_requestAccounts\", []);\n  } catch (error) {\n    if (error?.code === -32002) {\n      throw new Error(\n        \"MetaMask request already pending. Open MetaMask and approve first.\"\n      );\n    }\n    throw error;\n  }\n}\n\nexport async function ensureCorrectNetwork(provider) {\n  const network = await provider.getNetwork();\n  if (Number(network.chainId) === HARDHAT_LOCALHOST_CHAIN_ID) {\n    return;\n  }\n\n  const targetChainHex = `0x${HARDHAT_LOCALHOST_CHAIN_ID.toString(16)}`;\n  try {\n    await provider.send(\"wallet_switchEthereumChain\", [{ chainId: targetChainHex }]);\n  } catch (error) {\n    if (error?.code === 4902) {\n      await provider.send(\"wallet_addEthereumChain\", [\n        {\n          chainId: targetChainHex,\n          chainName: \"Hardhat Localhost\",\n          rpcUrls: [LOCAL_RPC_URL],\n          nativeCurrency: { name: \"ETH\", symbol: \"ETH\", decimals: 18 },\n        },\n      ]);\n      return;\n    }\n    throw new Error(\n      \"Wrong network in MetaMask. Switch to Hardhat Localhost (chainId 31337).\"\n    );\n  }\n}\n\nexport async function ensureContractCode(provider) {\n  if (\n    !contractAddress ||\n    contractAddress === \"0x0000000000000000000000000000000000000000\"\n  ) {\n    throw new Error(\n      \"Contract address is not configured. Run blockchain deploy first.\"\n    );\n  }\n\n  if (isContractCodeValidated) {\n    return;\n  }\n\n  let code = \"0x\";\n  try {\n    code = await provider.getCode(contractAddress);\n  } catch (error) {\n    const rpcMessage = String(error?.message || \"\");\n    const isRateLimit =\n      error?.code === -32002 ||\n      rpcMessage.includes(\"too many errors\") ||\n      rpcMessage.includes(\"retrying in\");\n\n    if (!isRateLimit) {\n      throw error;\n    }\n\n    // Fallback to local Hardhat RPC when wallet RPC is throttled.\n    code = await getLocalReadProvider().getCode(contractAddress);\n  }\n\n  if (!code || code === \"0x\") {\n    throw new Error(\n      `No contract found at ${contractAddress}. Redeploy and update config.`\n    );\n  }\n\n  isContractCodeValidated = true;\n}\n\nexport function getReadOnlyContract(provider) {\n  return new ethers.Contract(contractAddress, abi, provider);\n}\n\nexport function getWriteContract(signer) {\n  return new ethers.Contract(contractAddress, abi, signer);\n}\n\nexport function getContractRuntimeConfig() {\n  return {\n    contractAddress,\n    chainId: HARDHAT_LOCALHOST_CHAIN_ID,\n    version: LAND_REGISTRY_VERSION || \"legacy\",\n  };\n}\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}