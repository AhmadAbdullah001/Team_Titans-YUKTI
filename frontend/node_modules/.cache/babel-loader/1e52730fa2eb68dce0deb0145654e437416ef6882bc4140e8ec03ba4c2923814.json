{"ast":null,"code":"import _objectSpread from\"C:/Users/ahmad/OneDrive/Desktop/evault/frontend/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import React,{useEffect,useState}from\"react\";import{Link}from\"react-router-dom\";import{useNavigate}from\"react-router-dom\";import{pushHashOnChainWithWallet,getPropertyHistoryOnChain,getPropertyOwnerOnChain,propertyExistsOnChain,verifyPropertyOnChain}from\"../contract/propertyActions.js\";import{jsxs as _jsxs,jsx as _jsx}from\"react/jsx-runtime\";const API_BASE=\"http://localhost:5000\";const ZERO_ADDRESS=\"0x0000000000000000000000000000000000000000\";async function parseJsonSafe(response){const contentType=response.headers.get(\"content-type\")||\"\";if(!contentType.includes(\"application/json\")){const text=await response.text();throw new Error(\"API did not return JSON. Response started with: \".concat(text.slice(0,40)));}return response.json();}function maskHash(hash){const value=String(hash||\"\").trim();if(!value)return\"-\";if(value.length<=14)return value;return\"\".concat(value.slice(0,8),\"...\").concat(value.slice(-6));}function maskValue(value){const text=String(value||\"\").trim();if(!text)return\"-\";if(text.length<=10)return text;return\"\".concat(text.slice(0,4),\"...\").concat(text.slice(-4));}function RegistrarDashboard(){const navigate=useNavigate();const currentRole=String(localStorage.getItem(\"role\")||\"\").trim();const normalizedRole=currentRole===\"localAuthority\"?\"localauthority\":currentRole.toLowerCase();const isReviewerRole=[\"registrar\",\"notary\",\"localauthority\"].includes(normalizedRole);const roleLabel=currentRole===\"localAuthority\"?\"Local Authority\":currentRole?currentRole.charAt(0).toUpperCase()+currentRole.slice(1):\"Registrar\";const[files,setFiles]=useState([]);const[loading,setLoading]=useState(false);const[actionMessage,setActionMessage]=useState(\"\");const[processingHash,setProcessingHash]=useState(\"\");const[historyByHash,setHistoryByHash]=useState({});const[loadingHistoryHash,setLoadingHistoryHash]=useState(\"\");const[searchHash,setSearchHash]=useState(\"\");const[searchingOwner,setSearchingOwner]=useState(false);const[ownerDetails,setOwnerDetails]=useState(null);const[ownerSearchMessage,setOwnerSearchMessage]=useState(\"\");const logout=()=>{localStorage.removeItem(\"user\");localStorage.removeItem(\"role\");navigate(\"/login\",{replace:true});};const loadFiles=async()=>{if(!isReviewerRole){setActionMessage(\"Only registrar, notary, and local authority can review requests.\");setFiles([]);return;}setLoading(true);try{var _data2;let response=await fetch(\"\".concat(API_BASE,\"/api/files?role=\").concat(encodeURIComponent(currentRole)),{headers:{\"x-role\":currentRole}});let data;try{data=await parseJsonSafe(response);}catch(_unused){// Backward-compatible fallback to existing upload listing endpoint.\nresponse=await fetch(\"\".concat(API_BASE,\"/api/upload/all\"));data=await parseJsonSafe(response);}if(!response.ok){var _data;throw new Error(((_data=data)===null||_data===void 0?void 0:_data.message)||\"Failed to fetch files\");}const rows=Array.isArray((_data2=data)===null||_data2===void 0?void 0:_data2.files)?data.files:[];const withStatus=await Promise.all(rows.map(async item=>{let existsOnChain=null;let verifiedOnChain=false;let currentOwnerWallet=item.currentOwnerWallet||null;let transferHistoryCount=null;try{existsOnChain=await propertyExistsOnChain(item.ipfshash);}catch(_unused2){existsOnChain=null;}try{verifiedOnChain=await verifyPropertyOnChain(item.ipfshash);}catch(_unused3){verifiedOnChain=false;}try{currentOwnerWallet=await getPropertyOwnerOnChain(item.ipfshash);}catch(_unused4){// no-op\n}try{const history=await getPropertyHistoryOnChain(item.ipfshash);transferHistoryCount=Array.isArray(history)?history.filter(record=>{const from=String((record===null||record===void 0?void 0:record.from)||\"\").toLowerCase();const to=String((record===null||record===void 0?void 0:record.to)||\"\").toLowerCase();return from&&to&&from!==ZERO_ADDRESS&&to!==ZERO_ADDRESS;}).length:0;}catch(_unused5){transferHistoryCount=null;}return _objectSpread(_objectSpread({},item),{},{existsOnChain,verifiedOnChain:Boolean(verifiedOnChain),currentOwnerWallet,transferHistoryCount});}));setFiles(withStatus);}catch(error){setActionMessage((error===null||error===void 0?void 0:error.message)||\"Failed to load files. Ensure backend is running on http://localhost:5000.\");}finally{setLoading(false);}};useEffect(()=>{loadFiles();},[]);// eslint-disable-line react-hooks/exhaustive-deps\nconst reviewRequest=async(hash,decision)=>{try{var _data4;setProcessingHash(hash);setActionMessage(decision===\"approve\"?\"Submitting approval...\":\"Submitting rejection...\");const response=await fetch(\"\".concat(API_BASE,\"/api/files/review\"),{method:\"PATCH\",headers:{\"Content-Type\":\"application/json\",\"x-role\":currentRole},body:JSON.stringify({hash,role:currentRole,reviewerWallet:localStorage.getItem(\"walletAddress\")||null,decision})});const contentType=response.headers.get(\"content-type\")||\"\";let data=null;if(contentType.includes(\"application/json\")){data=await response.json();}else{const raw=await response.text();if(response.status===404){throw new Error(\"Review API not found. Restart backend so /api/files/review route is loaded.\");}throw new Error(\"Review API returned non-JSON response (status \".concat(response.status,\"). Response starts with: \").concat(raw.replace(/\\s+/g,\" \").slice(0,80)));}if(!response.ok){var _data3;throw new Error(((_data3=data)===null||_data3===void 0?void 0:_data3.message)||\"Failed to submit review\");}setActionMessage(((_data4=data)===null||_data4===void 0?void 0:_data4.message)||\"Review submitted.\");await loadFiles();}catch(error){setActionMessage((error===null||error===void 0?void 0:error.message)||\"Review failed\");}finally{setProcessingHash(\"\");}};const retryChainPush=async hash=>{try{setProcessingHash(hash);setActionMessage(\"Waiting for MetaMask confirmation...\");const txHash=await pushHashOnChainWithWallet(hash);setActionMessage(\"MetaMask tx confirmed. Syncing backend status...\");const response=await fetch(\"\".concat(API_BASE,\"/api/files/confirm-chain-push\"),{method:\"PATCH\",headers:{\"Content-Type\":\"application/json\",\"x-role\":currentRole},body:JSON.stringify({hash,role:currentRole,txHash})});const data=await parseJsonSafe(response);if(!response.ok){throw new Error((data===null||data===void 0?void 0:data.message)||\"Retry failed\");}setActionMessage(\"\".concat((data===null||data===void 0?void 0:data.message)||\"Blockchain push successful.\").concat(txHash?\" Tx: \".concat(txHash):\"\"));await loadFiles();}catch(error){setActionMessage((error===null||error===void 0?void 0:error.message)||\"Retry failed\");}finally{setProcessingHash(\"\");}};const loadHistory=async hash=>{try{setLoadingHistoryHash(hash);const history=await getPropertyHistoryOnChain(hash);setHistoryByHash(prev=>_objectSpread(_objectSpread({},prev),{},{[hash]:history}));}catch(error){setActionMessage((error===null||error===void 0?void 0:error.message)||\"Failed to fetch property history\");}finally{setLoadingHistoryHash(\"\");}};const searchOwnerByHash=async()=>{const value=String(searchHash||\"\").trim();if(!value){setOwnerSearchMessage(\"Enter property hash first.\");setOwnerDetails(null);return;}try{setSearchingOwner(true);setOwnerSearchMessage(\"\");setOwnerDetails(null);const response=await fetch(\"\".concat(API_BASE,\"/api/property/\").concat(encodeURIComponent(value),\"?role=\").concat(encodeURIComponent(currentRole)),{headers:{\"x-role\":currentRole}});const data=await parseJsonSafe(response);if(!response.ok){throw new Error((data===null||data===void 0?void 0:data.message)||\"Failed to search property owner\");}setOwnerDetails(data);}catch(error){setOwnerSearchMessage((error===null||error===void 0?void 0:error.message)||\"Failed to search owner by hash.\");}finally{setSearchingOwner(false);}};const copyHash=async hash=>{const value=String(hash||\"\").trim();if(!value)return;try{await navigator.clipboard.writeText(value);setActionMessage(\"Property hash copied.\");}catch(_unused6){setActionMessage(\"Copy failed. Please copy manually.\");}};return/*#__PURE__*/_jsx(\"div\",{className:\"min-h-screen bg-gradient-to-br from-slate-100 via-slate-50 to-sky-100 p-4 md:p-6\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"mx-auto max-w-7xl space-y-6\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"rounded-2xl bg-white p-6 shadow-lg ring-1 ring-slate-200\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"flex flex-col gap-3 sm:flex-row sm:items-center sm:justify-between\",children:[/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsxs(\"h1\",{className:\"text-2xl font-bold tracking-tight text-slate-900\",children:[roleLabel,\" Dashboard\"]}),/*#__PURE__*/_jsx(\"p\",{className:\"text-sm text-slate-600\",children:\"Review requests. 2 approvals -> on-chain push. 2 rejects -> rejected.\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center gap-2\",children:[/*#__PURE__*/_jsx(Link,{to:\"/user-lookup\",className:\"rounded-xl bg-sky-600 px-4 py-2 text-sm font-semibold text-white shadow hover:bg-sky-700\",children:\"User Lookup\"}),/*#__PURE__*/_jsx(Link,{to:\"/explorer\",className:\"rounded-xl bg-indigo-600 px-4 py-2 text-sm font-semibold text-white shadow hover:bg-indigo-700\",children:\"Explorer\"}),/*#__PURE__*/_jsx(\"button\",{onClick:logout,className:\"rounded-xl bg-rose-600 px-4 py-2 text-sm font-semibold text-white shadow hover:bg-rose-700\",children:\"Logout\"})]})]})}),/*#__PURE__*/_jsx(\"div\",{className:\"grid gap-6 lg:grid-cols-2\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"rounded-2xl bg-white p-6 shadow-lg ring-1 ring-slate-200\",children:[/*#__PURE__*/_jsx(\"h2\",{className:\"text-lg font-semibold text-slate-900\",children:\"Search By Property Hash\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"mt-3 flex flex-col gap-2 sm:flex-row\",children:[/*#__PURE__*/_jsx(\"input\",{type:\"text\",value:searchHash,onChange:e=>setSearchHash(e.target.value),placeholder:\"Enter property hash\",className:\"w-full rounded-xl border border-slate-300 px-3 py-2 text-xs outline-none focus:border-indigo-500\"}),/*#__PURE__*/_jsx(\"button\",{onClick:searchOwnerByHash,disabled:searchingOwner,className:\"rounded-xl px-4 py-2 text-xs font-semibold text-white \".concat(searchingOwner?\"cursor-not-allowed bg-slate-400\":\"bg-indigo-600 hover:bg-indigo-700\"),children:searchingOwner?\"Searching...\":\"Search\"})]}),ownerSearchMessage&&/*#__PURE__*/_jsx(\"p\",{className:\"mt-3 rounded-lg border border-rose-200 bg-rose-50 px-3 py-2 text-xs text-rose-700\",children:ownerSearchMessage}),ownerDetails&&/*#__PURE__*/_jsxs(\"div\",{className:\"mt-3 rounded-xl border border-slate-200 bg-slate-50 p-4\",children:[/*#__PURE__*/_jsx(\"p\",{className:\"text-xs font-semibold uppercase tracking-wide text-slate-700\",children:\"Owner Details\"}),/*#__PURE__*/_jsxs(\"p\",{className:\"mt-2 break-all text-xs text-slate-700\",children:[\"Wallet: \",/*#__PURE__*/_jsx(\"span\",{className:\"font-mono\",children:ownerDetails.walletAddress||\"-\"})]}),/*#__PURE__*/_jsxs(\"p\",{className:\"mt-1 text-xs text-slate-700\",children:[\"Name: \",ownerDetails.name||\"-\"]}),/*#__PURE__*/_jsxs(\"p\",{className:\"mt-1 text-xs text-slate-700\",children:[\"Role: \",ownerDetails.role||\"-\"]}),/*#__PURE__*/_jsxs(\"p\",{className:\"mt-1 text-xs text-slate-700\",children:[\"Aadhaar: \",ownerDetails.aadhaar||\"-\"]})]})]})}),/*#__PURE__*/_jsxs(\"div\",{className:\"rounded-2xl bg-white p-6 shadow-lg ring-1 ring-slate-200\",children:[/*#__PURE__*/_jsx(\"h2\",{className:\"text-lg font-semibold text-slate-900\",children:\"Property Queue\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"mt-3 rounded-xl border border-indigo-200 bg-indigo-50 p-3 text-xs text-indigo-900\",children:[/*#__PURE__*/_jsxs(\"p\",{className:\"font-semibold\",children:[roleLabel,\" Workflow\"]}),/*#__PURE__*/_jsx(\"p\",{className:\"mt-1\",children:\"1) Any 2 approvals from registrar/notary/local authority will push hash on-chain.\"}),/*#__PURE__*/_jsx(\"p\",{className:\"mt-1\",children:\"2) If 2 rejects are received, request becomes rejected.\"}),/*#__PURE__*/_jsx(\"p\",{className:\"mt-1\",children:\"3) Each role can submit only one decision per request.\"})]}),actionMessage&&/*#__PURE__*/_jsx(\"p\",{className:\"mt-3 rounded-lg border border-sky-200 bg-sky-50 px-3 py-2 text-sm text-sky-800\",children:actionMessage}),loading?/*#__PURE__*/_jsx(\"p\",{className:\"mt-4 text-sm text-slate-500\",children:\"Loading documents...\"}):files.length===0?/*#__PURE__*/_jsx(\"p\",{className:\"mt-4 text-sm text-slate-500\",children:\"No uploaded files found.\"}):/*#__PURE__*/_jsx(\"div\",{className:\"mt-4 overflow-x-auto rounded-xl border border-slate-200\",children:/*#__PURE__*/_jsxs(\"table\",{className:\"min-w-full divide-y divide-slate-200\",children:[/*#__PURE__*/_jsx(\"thead\",{children:/*#__PURE__*/_jsxs(\"tr\",{className:\"bg-slate-50 text-left text-xs uppercase tracking-wide text-slate-600\",children:[/*#__PURE__*/_jsx(\"th\",{className:\"px-3 py-2\",children:\"File\"}),/*#__PURE__*/_jsx(\"th\",{className:\"px-3 py-2\",children:\"Owner ID\"}),/*#__PURE__*/_jsx(\"th\",{className:\"px-3 py-2\",children:\"Hash\"}),/*#__PURE__*/_jsx(\"th\",{className:\"px-3 py-2\",children:\"Current Owner\"}),/*#__PURE__*/_jsx(\"th\",{className:\"px-3 py-2\",children:\"Workflow\"}),/*#__PURE__*/_jsx(\"th\",{className:\"px-3 py-2\",children:\"Status\"}),/*#__PURE__*/_jsx(\"th\",{className:\"px-3 py-2\",children:\"Approvals\"}),/*#__PURE__*/_jsx(\"th\",{className:\"px-3 py-2\",children:\"Rejects\"}),/*#__PURE__*/_jsx(\"th\",{className:\"px-3 py-2\",children:\"Action\"})]})}),/*#__PURE__*/_jsx(\"tbody\",{className:\"divide-y divide-slate-100 bg-white\",children:files.map(item=>{var _item$roleDecisions,_item$roleDecisions$c,_item$roleDecisions2,_item$roleDecisions2$,_item$roleDecisions3,_item$roleDecisions3$,_item$roleDecisions4,_item$roleDecisions4$;return/*#__PURE__*/_jsxs(React.Fragment,{children:[/*#__PURE__*/_jsxs(\"tr\",{className:\"hover:bg-slate-50\",children:[/*#__PURE__*/_jsx(\"td\",{className:\"px-3 py-2 text-sm text-slate-800\",children:item.filename}),/*#__PURE__*/_jsx(\"td\",{className:\"px-3 py-2\",children:/*#__PURE__*/_jsx(\"button\",{type:\"button\",onClick:()=>copyHash(item.userID),title:item.userID,className:\"text-sm text-slate-700 underline decoration-dotted underline-offset-2 hover:text-indigo-700\",children:maskValue(item.userID)})}),/*#__PURE__*/_jsx(\"td\",{className:\"px-3 py-2\",children:/*#__PURE__*/_jsx(\"button\",{type:\"button\",onClick:()=>copyHash(item.ipfshash),title:item.ipfshash,className:\"font-mono text-xs text-slate-700 underline decoration-dotted underline-offset-2 hover:text-indigo-700\",children:maskHash(item.ipfshash)})}),/*#__PURE__*/_jsx(\"td\",{className:\"px-3 py-2\",children:/*#__PURE__*/_jsx(\"button\",{type:\"button\",onClick:()=>copyHash(item.currentOwnerWallet),title:item.currentOwnerWallet||\"-\",className:\"font-mono text-xs text-slate-700 underline decoration-dotted underline-offset-2 hover:text-indigo-700\",children:maskValue(item.currentOwnerWallet)})}),/*#__PURE__*/_jsx(\"td\",{className:\"px-3 py-2 text-xs text-slate-700\",children:item.workflowStatus||\"pending\"}),/*#__PURE__*/_jsx(\"td\",{className:\"px-3 py-2 text-sm\",children:/*#__PURE__*/_jsx(\"span\",{className:item.verified||item.verifiedOnChain?\"text-emerald-700 font-medium\":item.existsOnChain===false?\"text-rose-700 font-medium\":item.existsOnChain?\"text-amber-700 font-medium\":\"text-amber-700 font-medium\",children:item.verified||item.verifiedOnChain?\"Verified\":item.workflowStatus===\"rejected\"?\"Rejected\":\"Pending Review\"})}),/*#__PURE__*/_jsx(\"td\",{className:\"px-3 py-2 text-xs text-slate-700\",children:Number(item.approvalCount||0)}),/*#__PURE__*/_jsx(\"td\",{className:\"px-3 py-2 text-xs text-slate-700\",children:Number(item.rejectCount||0)}),/*#__PURE__*/_jsx(\"td\",{className:\"px-3 py-2\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"flex flex-col gap-2\",children:[/*#__PURE__*/_jsx(\"a\",{href:\"https://gateway.pinata.cloud/ipfs/\".concat(item.ipfshash),target:\"_blank\",rel:\"noreferrer\",className:\"rounded-lg bg-indigo-600 px-3 py-1.5 text-center text-xs font-semibold text-white hover:bg-indigo-700\",children:\"View Document\"}),/*#__PURE__*/_jsx(\"button\",{onClick:()=>reviewRequest(item.ipfshash,\"approve\"),disabled:!isReviewerRole||item.workflowStatus===\"approved\"||item.workflowStatus===\"rejected\"||processingHash===item.ipfshash||Boolean(item===null||item===void 0?void 0:(_item$roleDecisions=item.roleDecisions)===null||_item$roleDecisions===void 0?void 0:(_item$roleDecisions$c=_item$roleDecisions[currentRole])===null||_item$roleDecisions$c===void 0?void 0:_item$roleDecisions$c.decision),className:\"rounded-lg px-3 py-1.5 text-xs font-semibold text-white \".concat(!isReviewerRole||item.workflowStatus===\"approved\"||item.workflowStatus===\"rejected\"||processingHash===item.ipfshash||Boolean(item===null||item===void 0?void 0:(_item$roleDecisions2=item.roleDecisions)===null||_item$roleDecisions2===void 0?void 0:(_item$roleDecisions2$=_item$roleDecisions2[currentRole])===null||_item$roleDecisions2$===void 0?void 0:_item$roleDecisions2$.decision)?\"cursor-not-allowed bg-slate-400\":\"bg-amber-600 hover:bg-amber-700\"),children:processingHash===item.ipfshash?\"Approving...\":\"Approve\"}),/*#__PURE__*/_jsx(\"button\",{onClick:()=>reviewRequest(item.ipfshash,\"reject\"),disabled:!isReviewerRole||item.workflowStatus===\"approved\"||item.workflowStatus===\"rejected\"||processingHash===item.ipfshash||Boolean(item===null||item===void 0?void 0:(_item$roleDecisions3=item.roleDecisions)===null||_item$roleDecisions3===void 0?void 0:(_item$roleDecisions3$=_item$roleDecisions3[currentRole])===null||_item$roleDecisions3$===void 0?void 0:_item$roleDecisions3$.decision),className:\"rounded-lg px-3 py-1.5 text-xs font-semibold text-white \".concat(!isReviewerRole||item.workflowStatus===\"approved\"||item.workflowStatus===\"rejected\"||processingHash===item.ipfshash||Boolean(item===null||item===void 0?void 0:(_item$roleDecisions4=item.roleDecisions)===null||_item$roleDecisions4===void 0?void 0:(_item$roleDecisions4$=_item$roleDecisions4[currentRole])===null||_item$roleDecisions4$===void 0?void 0:_item$roleDecisions4$.decision)?\"cursor-not-allowed bg-slate-400\":\"bg-rose-600 hover:bg-rose-700\"),children:processingHash===item.ipfshash?\"Submitting...\":\"Reject\"}),Number(item.approvalCount||0)>=2&&item.workflowStatus===\"approved_pending_chain\"&&/*#__PURE__*/_jsx(\"button\",{onClick:()=>retryChainPush(item.ipfshash),disabled:!isReviewerRole||processingHash===item.ipfshash,className:\"rounded-lg px-3 py-1.5 text-xs font-semibold text-white \".concat(!isReviewerRole||processingHash===item.ipfshash?\"cursor-not-allowed bg-slate-400\":\"bg-emerald-600 hover:bg-emerald-700\"),children:processingHash===item.ipfshash?\"Retrying...\":\"Retry Chain Push\"}),/*#__PURE__*/_jsx(\"button\",{onClick:()=>loadHistory(item.ipfshash),disabled:loadingHistoryHash===item.ipfshash,className:\"rounded-lg px-3 py-1.5 text-xs font-semibold text-white \".concat(loadingHistoryHash===item.ipfshash?\"cursor-not-allowed bg-slate-400\":\"bg-sky-600 hover:bg-sky-700\"),children:loadingHistoryHash===item.ipfshash?\"Loading...\":\"View History\"})]})})]}),historyByHash[item.ipfshash]&&/*#__PURE__*/_jsx(\"tr\",{children:/*#__PURE__*/_jsxs(\"td\",{colSpan:9,className:\"bg-slate-50 px-3 py-2\",children:[/*#__PURE__*/_jsx(\"p\",{className:\"text-xs font-semibold text-slate-700\",children:\"Transfer History\"}),historyByHash[item.ipfshash].length===0?/*#__PURE__*/_jsx(\"p\",{className:\"text-xs text-slate-500\",children:\"No transfer records.\"}):/*#__PURE__*/_jsx(\"div\",{className:\"mt-1 space-y-1\",children:historyByHash[item.ipfshash].map((record,idx)=>/*#__PURE__*/_jsxs(\"p\",{className:\"break-all font-mono text-[11px] text-slate-600\",children:[record.from,\" -> \",record.to,\" at\",\" \",record.timestamp?new Date(record.timestamp*1000).toLocaleString():\"-\"]},\"\".concat(item.ipfshash,\"-\").concat(idx)))})]})})]},item._id);})})]})})]})]})});}export default RegistrarDashboard;","map":{"version":3,"names":["React","useEffect","useState","Link","useNavigate","pushHashOnChainWithWallet","getPropertyHistoryOnChain","getPropertyOwnerOnChain","propertyExistsOnChain","verifyPropertyOnChain","jsxs","_jsxs","jsx","_jsx","API_BASE","ZERO_ADDRESS","parseJsonSafe","response","contentType","headers","get","includes","text","Error","concat","slice","json","maskHash","hash","value","String","trim","length","maskValue","RegistrarDashboard","navigate","currentRole","localStorage","getItem","normalizedRole","toLowerCase","isReviewerRole","roleLabel","charAt","toUpperCase","files","setFiles","loading","setLoading","actionMessage","setActionMessage","processingHash","setProcessingHash","historyByHash","setHistoryByHash","loadingHistoryHash","setLoadingHistoryHash","searchHash","setSearchHash","searchingOwner","setSearchingOwner","ownerDetails","setOwnerDetails","ownerSearchMessage","setOwnerSearchMessage","logout","removeItem","replace","loadFiles","_data2","fetch","encodeURIComponent","data","_unused","ok","_data","message","rows","Array","isArray","withStatus","Promise","all","map","item","existsOnChain","verifiedOnChain","currentOwnerWallet","transferHistoryCount","ipfshash","_unused2","_unused3","_unused4","history","filter","record","from","to","_unused5","_objectSpread","Boolean","error","reviewRequest","decision","_data4","method","body","JSON","stringify","role","reviewerWallet","raw","status","_data3","retryChainPush","txHash","loadHistory","prev","searchOwnerByHash","copyHash","navigator","clipboard","writeText","_unused6","className","children","onClick","type","onChange","e","target","placeholder","disabled","walletAddress","name","aadhaar","_item$roleDecisions","_item$roleDecisions$c","_item$roleDecisions2","_item$roleDecisions2$","_item$roleDecisions3","_item$roleDecisions3$","_item$roleDecisions4","_item$roleDecisions4$","Fragment","filename","userID","title","workflowStatus","verified","Number","approvalCount","rejectCount","href","rel","roleDecisions","colSpan","idx","timestamp","Date","toLocaleString","_id"],"sources":["C:/Users/ahmad/OneDrive/Desktop/evault/frontend/src/pages/RegistrarDashboard.js"],"sourcesContent":["import React, { useEffect, useState } from \"react\";\nimport { Link } from \"react-router-dom\";\nimport { useNavigate } from \"react-router-dom\";\nimport {\n  pushHashOnChainWithWallet,\n  getPropertyHistoryOnChain,\n  getPropertyOwnerOnChain,\n  propertyExistsOnChain,\n  verifyPropertyOnChain,\n} from \"../contract/propertyActions.js\";\n\r\nconst API_BASE = \"http://localhost:5000\";\r\nconst ZERO_ADDRESS = \"0x0000000000000000000000000000000000000000\";\r\n\r\nasync function parseJsonSafe(response) {\r\n  const contentType = response.headers.get(\"content-type\") || \"\";\r\n  if (!contentType.includes(\"application/json\")) {\r\n    const text = await response.text();\r\n    throw new Error(\r\n      `API did not return JSON. Response started with: ${text.slice(0, 40)}`\r\n    );\r\n  }\r\n  return response.json();\r\n}\r\n\r\nfunction maskHash(hash) {\r\n  const value = String(hash || \"\").trim();\r\n  if (!value) return \"-\";\r\n  if (value.length <= 14) return value;\r\n  return `${value.slice(0, 8)}...${value.slice(-6)}`;\r\n}\r\n\r\nfunction maskValue(value) {\r\n  const text = String(value || \"\").trim();\r\n  if (!text) return \"-\";\r\n  if (text.length <= 10) return text;\r\n  return `${text.slice(0, 4)}...${text.slice(-4)}`;\r\n}\r\n\r\nfunction RegistrarDashboard() {\n  const navigate = useNavigate();\n  const currentRole = String(localStorage.getItem(\"role\") || \"\").trim();\n  const normalizedRole = currentRole === \"localAuthority\" ? \"localauthority\" : currentRole.toLowerCase();\n  const isReviewerRole = [\"registrar\", \"notary\", \"localauthority\"].includes(normalizedRole);\n  const roleLabel =\n    currentRole === \"localAuthority\"\n      ? \"Local Authority\"\n      : currentRole\n      ? currentRole.charAt(0).toUpperCase() + currentRole.slice(1)\n      : \"Registrar\";\n  const [files, setFiles] = useState([]);\n  const [loading, setLoading] = useState(false);\n  const [actionMessage, setActionMessage] = useState(\"\");\n  const [processingHash, setProcessingHash] = useState(\"\");\n  const [historyByHash, setHistoryByHash] = useState({});\n  const [loadingHistoryHash, setLoadingHistoryHash] = useState(\"\");\n  const [searchHash, setSearchHash] = useState(\"\");\r\n  const [searchingOwner, setSearchingOwner] = useState(false);\r\n  const [ownerDetails, setOwnerDetails] = useState(null);\r\n  const [ownerSearchMessage, setOwnerSearchMessage] = useState(\"\");\r\n\r\n  const logout = () => {\r\n    localStorage.removeItem(\"user\");\r\n    localStorage.removeItem(\"role\");\r\n    navigate(\"/login\", { replace: true });\r\n  };\r\n\r\n  const loadFiles = async () => {\n    if (!isReviewerRole) {\n      setActionMessage(\"Only registrar, notary, and local authority can review requests.\");\n      setFiles([]);\n      return;\n    }\n    setLoading(true);\n    try {\n      let response = await fetch(`${API_BASE}/api/files?role=${encodeURIComponent(currentRole)}`, {\n        headers: { \"x-role\": currentRole },\n      });\n      let data;\r\n\r\n      try {\r\n        data = await parseJsonSafe(response);\r\n      } catch {\r\n        // Backward-compatible fallback to existing upload listing endpoint.\r\n        response = await fetch(`${API_BASE}/api/upload/all`);\r\n        data = await parseJsonSafe(response);\r\n      }\r\n\r\n      if (!response.ok) {\r\n        throw new Error(data?.message || \"Failed to fetch files\");\r\n      }\r\n\r\n      const rows = Array.isArray(data?.files) ? data.files : [];\r\n      const withStatus = await Promise.all(\r\n        rows.map(async (item) => {\r\n          let existsOnChain = null;\r\n          let verifiedOnChain = false;\r\n          let currentOwnerWallet = item.currentOwnerWallet || null;\r\n          let transferHistoryCount = null;\r\n\r\n          try {\r\n            existsOnChain = await propertyExistsOnChain(item.ipfshash);\r\n          } catch {\r\n            existsOnChain = null;\r\n          }\r\n\r\n          try {\r\n            verifiedOnChain = await verifyPropertyOnChain(item.ipfshash);\r\n          } catch {\r\n            verifiedOnChain = false;\r\n          }\r\n\r\n          try {\r\n            currentOwnerWallet = await getPropertyOwnerOnChain(item.ipfshash);\r\n          } catch {\r\n            // no-op\r\n          }\r\n\r\n          try {\r\n            const history = await getPropertyHistoryOnChain(item.ipfshash);\r\n            transferHistoryCount = Array.isArray(history)\r\n              ? history.filter((record) => {\r\n                  const from = String(record?.from || \"\").toLowerCase();\r\n                  const to = String(record?.to || \"\").toLowerCase();\r\n                  return from && to && from !== ZERO_ADDRESS && to !== ZERO_ADDRESS;\r\n                }).length\r\n              : 0;\r\n          } catch {\r\n            transferHistoryCount = null;\r\n          }\r\n\r\n          return {\r\n            ...item,\r\n            existsOnChain,\r\n            verifiedOnChain: Boolean(verifiedOnChain),\r\n            currentOwnerWallet,\r\n            transferHistoryCount,\r\n          };\r\n        })\r\n      );\r\n      setFiles(withStatus);\r\n    } catch (error) {\r\n      setActionMessage(\r\n        error?.message ||\r\n          \"Failed to load files. Ensure backend is running on http://localhost:5000.\"\r\n      );\r\n    } finally {\r\n      setLoading(false);\n    }\n  };\n\n  useEffect(() => {\n    loadFiles();\n  }, []); // eslint-disable-line react-hooks/exhaustive-deps\n\n  const reviewRequest = async (hash, decision) => {\n    try {\n      setProcessingHash(hash);\n      setActionMessage(\n        decision === \"approve\" ? \"Submitting approval...\" : \"Submitting rejection...\"\n      );\n\n      const response = await fetch(`${API_BASE}/api/files/review`, {\n        method: \"PATCH\",\n        headers: { \"Content-Type\": \"application/json\", \"x-role\": currentRole },\n        body: JSON.stringify({\n          hash,\n          role: currentRole,\n          reviewerWallet: localStorage.getItem(\"walletAddress\") || null,\n          decision,\n        }),\n      });\n      const contentType = response.headers.get(\"content-type\") || \"\";\n      let data = null;\n      if (contentType.includes(\"application/json\")) {\n        data = await response.json();\n      } else {\n        const raw = await response.text();\n        if (response.status === 404) {\n          throw new Error(\n            \"Review API not found. Restart backend so /api/files/review route is loaded.\"\n          );\n        }\n        throw new Error(\n          `Review API returned non-JSON response (status ${response.status}). Response starts with: ${raw\n            .replace(/\\s+/g, \" \")\n            .slice(0, 80)}`\n        );\n      }\n      if (!response.ok) {\n        throw new Error(data?.message || \"Failed to submit review\");\n      }\n\n      setActionMessage(data?.message || \"Review submitted.\");\n      await loadFiles();\n    } catch (error) {\n      setActionMessage(error?.message || \"Review failed\");\n    } finally {\n      setProcessingHash(\"\");\n    }\n  };\n\n  const retryChainPush = async (hash) => {\n    try {\n      setProcessingHash(hash);\n      setActionMessage(\"Waiting for MetaMask confirmation...\");\n      const txHash = await pushHashOnChainWithWallet(hash);\n\n      setActionMessage(\"MetaMask tx confirmed. Syncing backend status...\");\n      const response = await fetch(`${API_BASE}/api/files/confirm-chain-push`, {\n        method: \"PATCH\",\n        headers: { \"Content-Type\": \"application/json\", \"x-role\": currentRole },\n        body: JSON.stringify({ hash, role: currentRole, txHash }),\n      });\n      const data = await parseJsonSafe(response);\n      if (!response.ok) {\n        throw new Error(data?.message || \"Retry failed\");\n      }\n      setActionMessage(\n        `${data?.message || \"Blockchain push successful.\"}${\n          txHash ? ` Tx: ${txHash}` : \"\"\n        }`\n      );\n      await loadFiles();\n    } catch (error) {\n      setActionMessage(error?.message || \"Retry failed\");\n    } finally {\n      setProcessingHash(\"\");\n    }\n  };\n\r\n  const loadHistory = async (hash) => {\r\n    try {\r\n      setLoadingHistoryHash(hash);\r\n      const history = await getPropertyHistoryOnChain(hash);\r\n      setHistoryByHash((prev) => ({ ...prev, [hash]: history }));\r\n    } catch (error) {\r\n      setActionMessage(error?.message || \"Failed to fetch property history\");\r\n    } finally {\r\n      setLoadingHistoryHash(\"\");\r\n    }\r\n  };\r\n\r\n  const searchOwnerByHash = async () => {\r\n    const value = String(searchHash || \"\").trim();\r\n    if (!value) {\r\n      setOwnerSearchMessage(\"Enter property hash first.\");\r\n      setOwnerDetails(null);\r\n      return;\r\n    }\r\n\r\n    try {\r\n      setSearchingOwner(true);\r\n      setOwnerSearchMessage(\"\");\r\n      setOwnerDetails(null);\r\n\r\n      const response = await fetch(\n        `${API_BASE}/api/property/${encodeURIComponent(value)}?role=${encodeURIComponent(currentRole)}`,\n        { headers: { \"x-role\": currentRole } }\n      );\n      const data = await parseJsonSafe(response);\r\n      if (!response.ok) {\r\n        throw new Error(data?.message || \"Failed to search property owner\");\r\n      }\r\n\r\n      setOwnerDetails(data);\r\n    } catch (error) {\r\n      setOwnerSearchMessage(error?.message || \"Failed to search owner by hash.\");\r\n    } finally {\r\n      setSearchingOwner(false);\r\n    }\r\n  };\r\n\r\n  const copyHash = async (hash) => {\r\n    const value = String(hash || \"\").trim();\r\n    if (!value) return;\r\n    try {\r\n      await navigator.clipboard.writeText(value);\r\n      setActionMessage(\"Property hash copied.\");\r\n    } catch {\r\n      setActionMessage(\"Copy failed. Please copy manually.\");\r\n    }\r\n  };\r\n\r\n  return (\r\n    <div className=\"min-h-screen bg-gradient-to-br from-slate-100 via-slate-50 to-sky-100 p-4 md:p-6\">\r\n      <div className=\"mx-auto max-w-7xl space-y-6\">\r\n        <div className=\"rounded-2xl bg-white p-6 shadow-lg ring-1 ring-slate-200\">\r\n          <div className=\"flex flex-col gap-3 sm:flex-row sm:items-center sm:justify-between\">\r\n            <div>\n              <h1 className=\"text-2xl font-bold tracking-tight text-slate-900\">{roleLabel} Dashboard</h1>\n              <p className=\"text-sm text-slate-600\">\n                Review requests. 2 approvals -> on-chain push. 2 rejects -> rejected.\n              </p>\n            </div>\r\n            <div className=\"flex items-center gap-2\">\r\n              <Link\r\n                to=\"/user-lookup\"\r\n                className=\"rounded-xl bg-sky-600 px-4 py-2 text-sm font-semibold text-white shadow hover:bg-sky-700\"\r\n              >\r\n                User Lookup\r\n              </Link>\r\n              <Link\r\n                to=\"/explorer\"\r\n                className=\"rounded-xl bg-indigo-600 px-4 py-2 text-sm font-semibold text-white shadow hover:bg-indigo-700\"\r\n              >\r\n                Explorer\r\n              </Link>\r\n              <button\r\n                onClick={logout}\r\n                className=\"rounded-xl bg-rose-600 px-4 py-2 text-sm font-semibold text-white shadow hover:bg-rose-700\"\r\n              >\r\n                Logout\r\n              </button>\r\n            </div>\r\n          </div>\r\n        </div>\r\n\r\n        <div className=\"grid gap-6 lg:grid-cols-2\">\r\n\r\n\r\n          <div className=\"rounded-2xl bg-white p-6 shadow-lg ring-1 ring-slate-200\">\r\n            <h2 className=\"text-lg font-semibold text-slate-900\">Search By Property Hash</h2>\r\n            <div className=\"mt-3 flex flex-col gap-2 sm:flex-row\">\r\n              <input\r\n                type=\"text\"\r\n                value={searchHash}\r\n                onChange={(e) => setSearchHash(e.target.value)}\r\n                placeholder=\"Enter property hash\"\r\n                className=\"w-full rounded-xl border border-slate-300 px-3 py-2 text-xs outline-none focus:border-indigo-500\"\r\n              />\r\n              <button\r\n                onClick={searchOwnerByHash}\r\n                disabled={searchingOwner}\r\n                className={`rounded-xl px-4 py-2 text-xs font-semibold text-white ${\r\n                  searchingOwner ? \"cursor-not-allowed bg-slate-400\" : \"bg-indigo-600 hover:bg-indigo-700\"\r\n                }`}\r\n              >\r\n                {searchingOwner ? \"Searching...\" : \"Search\"}\r\n              </button>\r\n            </div>\r\n            {ownerSearchMessage && (\r\n              <p className=\"mt-3 rounded-lg border border-rose-200 bg-rose-50 px-3 py-2 text-xs text-rose-700\">\r\n                {ownerSearchMessage}\r\n              </p>\r\n            )}\r\n            {ownerDetails && (\r\n              <div className=\"mt-3 rounded-xl border border-slate-200 bg-slate-50 p-4\">\r\n                <p className=\"text-xs font-semibold uppercase tracking-wide text-slate-700\">Owner Details</p>\r\n                <p className=\"mt-2 break-all text-xs text-slate-700\">\r\n                  Wallet: <span className=\"font-mono\">{ownerDetails.walletAddress || \"-\"}</span>\r\n                </p>\r\n                <p className=\"mt-1 text-xs text-slate-700\">Name: {ownerDetails.name || \"-\"}</p>\r\n                <p className=\"mt-1 text-xs text-slate-700\">Role: {ownerDetails.role || \"-\"}</p>\r\n                <p className=\"mt-1 text-xs text-slate-700\">Aadhaar: {ownerDetails.aadhaar || \"-\"}</p>\r\n              </div>\r\n            )}\r\n          </div>\r\n        </div>\r\n\r\n        <div className=\"rounded-2xl bg-white p-6 shadow-lg ring-1 ring-slate-200\">\r\n          <h2 className=\"text-lg font-semibold text-slate-900\">Property Queue</h2>\r\n          <div className=\"mt-3 rounded-xl border border-indigo-200 bg-indigo-50 p-3 text-xs text-indigo-900\">\r\n            <p className=\"font-semibold\">{roleLabel} Workflow</p>\n            <p className=\"mt-1\">\n              1) Any 2 approvals from registrar/notary/local authority will push hash on-chain.\n            </p>\n            <p className=\"mt-1\">\n              2) If 2 rejects are received, request becomes rejected.\n            </p>\n            <p className=\"mt-1\">\n              3) Each role can submit only one decision per request.\n            </p>\n          </div>\r\n          {actionMessage && (\r\n            <p className=\"mt-3 rounded-lg border border-sky-200 bg-sky-50 px-3 py-2 text-sm text-sky-800\">\r\n              {actionMessage}\r\n            </p>\r\n          )}\r\n          {loading ? (\r\n            <p className=\"mt-4 text-sm text-slate-500\">Loading documents...</p>\r\n          ) : files.length === 0 ? (\r\n            <p className=\"mt-4 text-sm text-slate-500\">No uploaded files found.</p>\r\n          ) : (\r\n            <div className=\"mt-4 overflow-x-auto rounded-xl border border-slate-200\">\r\n              <table className=\"min-w-full divide-y divide-slate-200\">\r\n                <thead>\r\n                  <tr className=\"bg-slate-50 text-left text-xs uppercase tracking-wide text-slate-600\">\r\n                    <th className=\"px-3 py-2\">File</th>\r\n                    <th className=\"px-3 py-2\">Owner ID</th>\r\n                    <th className=\"px-3 py-2\">Hash</th>\r\n                    <th className=\"px-3 py-2\">Current Owner</th>\r\n                     <th className=\"px-3 py-2\">Workflow</th>\n                     <th className=\"px-3 py-2\">Status</th>\n                     <th className=\"px-3 py-2\">Approvals</th>\n                     <th className=\"px-3 py-2\">Rejects</th>\n                     <th className=\"px-3 py-2\">Action</th>\n                  </tr>\r\n                </thead>\r\n                <tbody className=\"divide-y divide-slate-100 bg-white\">\r\n                  {files.map((item) => (\r\n                    <React.Fragment key={item._id}>\r\n                    <tr className=\"hover:bg-slate-50\">\r\n                      <td className=\"px-3 py-2 text-sm text-slate-800\">{item.filename}</td>\r\n                      <td className=\"px-3 py-2\">\r\n                        <button\r\n                          type=\"button\"\r\n                          onClick={() => copyHash(item.userID)}\r\n                          title={item.userID}\r\n                          className=\"text-sm text-slate-700 underline decoration-dotted underline-offset-2 hover:text-indigo-700\"\r\n                        >\r\n                          {maskValue(item.userID)}\r\n                        </button>\r\n                      </td>\r\n                      <td className=\"px-3 py-2\">\r\n                        <button\r\n                          type=\"button\"\r\n                          onClick={() => copyHash(item.ipfshash)}\r\n                          title={item.ipfshash}\r\n                          className=\"font-mono text-xs text-slate-700 underline decoration-dotted underline-offset-2 hover:text-indigo-700\"\r\n                        >\r\n                          {maskHash(item.ipfshash)}\r\n                        </button>\r\n                      </td>\r\n                      <td className=\"px-3 py-2\">\r\n                        <button\r\n                          type=\"button\"\r\n                          onClick={() => copyHash(item.currentOwnerWallet)}\r\n                          title={item.currentOwnerWallet || \"-\"}\r\n                          className=\"font-mono text-xs text-slate-700 underline decoration-dotted underline-offset-2 hover:text-indigo-700\"\r\n                        >\r\n                          {maskValue(item.currentOwnerWallet)}\r\n                        </button>\r\n                      </td>\r\n                      <td className=\"px-3 py-2 text-xs text-slate-700\">\n                        {item.workflowStatus || \"pending\"}\n                      </td>\n                      <td className=\"px-3 py-2 text-sm\">\r\n                        <span\r\n                          className={\r\n                            item.verified || item.verifiedOnChain\r\n                              ? \"text-emerald-700 font-medium\"\r\n                              : item.existsOnChain === false\r\n                              ? \"text-rose-700 font-medium\"\r\n                              : item.existsOnChain\r\n                              ? \"text-amber-700 font-medium\"\r\n                              : \"text-amber-700 font-medium\"\r\n                          }\r\n                        >\r\n                          {item.verified || item.verifiedOnChain\r\n                            ? \"Verified\"\n                            : item.workflowStatus === \"rejected\"\n                            ? \"Rejected\"\n                            : \"Pending Review\"}\n                        </span>\n                      </td>\n                      <td className=\"px-3 py-2 text-xs text-slate-700\">{Number(item.approvalCount || 0)}</td>\n                      <td className=\"px-3 py-2 text-xs text-slate-700\">{Number(item.rejectCount || 0)}</td>\n                      <td className=\"px-3 py-2\">\n                        <div className=\"flex flex-col gap-2\">\n                          <a\r\n                            href={`https://gateway.pinata.cloud/ipfs/${item.ipfshash}`}\r\n                            target=\"_blank\"\r\n                            rel=\"noreferrer\"\r\n                            className=\"rounded-lg bg-indigo-600 px-3 py-1.5 text-center text-xs font-semibold text-white hover:bg-indigo-700\"\r\n                          >\r\n                            View Document\r\n                          </a>\r\n                          <button\r\n                            onClick={() => reviewRequest(item.ipfshash, \"approve\")}\n                            disabled={\n                              !isReviewerRole ||\n                              item.workflowStatus === \"approved\" ||\n                              item.workflowStatus === \"rejected\" ||\n                              processingHash === item.ipfshash ||\n                              Boolean(item?.roleDecisions?.[currentRole]?.decision)\n                            }\n                            className={`rounded-lg px-3 py-1.5 text-xs font-semibold text-white ${\n                              !isReviewerRole ||\n                              item.workflowStatus === \"approved\" ||\n                              item.workflowStatus === \"rejected\" ||\n                              processingHash === item.ipfshash ||\n                              Boolean(item?.roleDecisions?.[currentRole]?.decision)\n                                ? \"cursor-not-allowed bg-slate-400\"\n                                : \"bg-amber-600 hover:bg-amber-700\"\n                            }`}\n                          >\n                            {processingHash === item.ipfshash ? \"Approving...\" : \"Approve\"}\n                          </button>\n                          <button\n                            onClick={() => reviewRequest(item.ipfshash, \"reject\")}\n                            disabled={\n                              !isReviewerRole ||\n                              item.workflowStatus === \"approved\" ||\n                              item.workflowStatus === \"rejected\" ||\n                              processingHash === item.ipfshash ||\n                              Boolean(item?.roleDecisions?.[currentRole]?.decision)\n                            }\n                            className={`rounded-lg px-3 py-1.5 text-xs font-semibold text-white ${\n                              !isReviewerRole ||\n                              item.workflowStatus === \"approved\" ||\n                              item.workflowStatus === \"rejected\" ||\n                              processingHash === item.ipfshash ||\n                              Boolean(item?.roleDecisions?.[currentRole]?.decision)\n                                ? \"cursor-not-allowed bg-slate-400\"\n                                : \"bg-rose-600 hover:bg-rose-700\"\n                            }`}\n                          >\n                            {processingHash === item.ipfshash ? \"Submitting...\" : \"Reject\"}\n                          </button>\n                          {Number(item.approvalCount || 0) >= 2 &&\n                            item.workflowStatus === \"approved_pending_chain\" && (\n                              <button\n                                onClick={() => retryChainPush(item.ipfshash)}\n                                disabled={!isReviewerRole || processingHash === item.ipfshash}\n                                className={`rounded-lg px-3 py-1.5 text-xs font-semibold text-white ${\n                                  !isReviewerRole || processingHash === item.ipfshash\n                                    ? \"cursor-not-allowed bg-slate-400\"\n                                    : \"bg-emerald-600 hover:bg-emerald-700\"\n                                }`}\n                              >\n                                {processingHash === item.ipfshash ? \"Retrying...\" : \"Retry Chain Push\"}\n                              </button>\n                            )}\n                          <button\n                            onClick={() => loadHistory(item.ipfshash)}\n                            disabled={loadingHistoryHash === item.ipfshash}\r\n                            className={`rounded-lg px-3 py-1.5 text-xs font-semibold text-white ${\r\n                              loadingHistoryHash === item.ipfshash\r\n                                ? \"cursor-not-allowed bg-slate-400\"\r\n                                : \"bg-sky-600 hover:bg-sky-700\"\r\n                            }`}\r\n                          >\r\n                            {loadingHistoryHash === item.ipfshash ? \"Loading...\" : \"View History\"}\r\n                          </button>\r\n                        </div>\r\n                      </td>\r\n                    </tr>\r\n                    {historyByHash[item.ipfshash] && (\r\n                      <tr>\r\n                        <td colSpan={9} className=\"bg-slate-50 px-3 py-2\">\n                          <p className=\"text-xs font-semibold text-slate-700\">Transfer History</p>\r\n                          {historyByHash[item.ipfshash].length === 0 ? (\r\n                            <p className=\"text-xs text-slate-500\">No transfer records.</p>\r\n                          ) : (\r\n                            <div className=\"mt-1 space-y-1\">\r\n                              {historyByHash[item.ipfshash].map((record, idx) => (\r\n                                <p key={`${item.ipfshash}-${idx}`} className=\"break-all font-mono text-[11px] text-slate-600\">\r\n                                  {record.from} -> {record.to} at{\" \"}\r\n                                  {record.timestamp ? new Date(record.timestamp * 1000).toLocaleString() : \"-\"}\r\n                                </p>\r\n                              ))}\r\n                            </div>\r\n                          )}\r\n                        </td>\r\n                      </tr>\r\n                    )}\r\n                    </React.Fragment>\r\n                  ))}\r\n                </tbody>\r\n              </table>\r\n            </div>\r\n          )}\r\n        </div>\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\n\r\nexport default RegistrarDashboard;\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}