{"ast":null,"code":"import{ethers}from\"ethers\";import{getEVaultContract}from\"./web3.js\";export function statusLabel(status){const value=Number(status);if(value===0)return\"Pending\";if(value===1)return\"Rejected\";if(value===2)return\"Registered\";return\"Unknown\";}export async function requestRegistration(ipfsHash){const contract=await getEVaultContract(true);const tx=await contract.requestRegistration(ipfsHash);await tx.wait();return tx.hash;}export async function approveProperty(propertyId){const contract=await getEVaultContract(true);const tx=await contract.approveProperty(propertyId);await tx.wait();return tx.hash;}export async function transferProperty(propertyId,newOwner){const contract=await getEVaultContract(true);const tx=await contract.transferProperty(propertyId,newOwner);await tx.wait();return tx.hash;}export async function verifyByBank(propertyId){const contract=await getEVaultContract(true);const tx=await contract.verifyByBank(propertyId);await tx.wait();return tx.hash;}export async function getPropertyCounter(){const contract=await getEVaultContract(false);return Number(await contract.propertyCounter());}export async function getProperty(propertyId){const contract=await getEVaultContract(false);const property=await contract.properties(propertyId);return{id:Number(property.id),owner:property.owner,ipfsHash:property.ipfsHash,registrarApproved:Boolean(property.registrarApproved),notaryApproved:Boolean(property.notaryApproved),authorityApproved:Boolean(property.authorityApproved),approvalCount:Number(property.approvalCount),status:Number(property.status),bankVerified:Boolean(property.bankVerified)};}export async function getAllProperties(){const count=await getPropertyCounter();if(count===0)return[];const ids=Array.from({length:count},(_,i)=>i+1);const properties=await Promise.all(ids.map(id=>getProperty(id)));return properties.filter(property=>property.id>0);}export async function getOwnershipHistory(propertyId){const contract=await getEVaultContract(false);const records=await contract.getOwnershipHistory(propertyId);return records.map(record=>({owner:record.owner,timestamp:Number(record.timestamp),readableTime:Number(record.timestamp)>0?new Date(Number(record.timestamp)*1000).toLocaleString():\"-\"}));}export function isValidAddress(value){return ethers.isAddress(value);}","map":{"version":3,"names":["ethers","getEVaultContract","statusLabel","status","value","Number","requestRegistration","ipfsHash","contract","tx","wait","hash","approveProperty","propertyId","transferProperty","newOwner","verifyByBank","getPropertyCounter","propertyCounter","getProperty","property","properties","id","owner","registrarApproved","Boolean","notaryApproved","authorityApproved","approvalCount","bankVerified","getAllProperties","count","ids","Array","from","length","_","i","Promise","all","map","filter","getOwnershipHistory","records","record","timestamp","readableTime","Date","toLocaleString","isValidAddress","isAddress"],"sources":["C:/Users/ahmad/OneDrive/Desktop/evault/frontend/src/utils/evault.js"],"sourcesContent":["import { ethers } from \"ethers\";\nimport { getEVaultContract } from \"./web3.js\";\n\nexport function statusLabel(status) {\n  const value = Number(status);\n  if (value === 0) return \"Pending\";\n  if (value === 1) return \"Rejected\";\n  if (value === 2) return \"Registered\";\n  return \"Unknown\";\n}\n\nexport async function requestRegistration(ipfsHash) {\n  const contract = await getEVaultContract(true);\n  const tx = await contract.requestRegistration(ipfsHash);\n  await tx.wait();\n  return tx.hash;\n}\n\nexport async function approveProperty(propertyId) {\n  const contract = await getEVaultContract(true);\n  const tx = await contract.approveProperty(propertyId);\n  await tx.wait();\n  return tx.hash;\n}\n\nexport async function transferProperty(propertyId, newOwner) {\n  const contract = await getEVaultContract(true);\n  const tx = await contract.transferProperty(propertyId, newOwner);\n  await tx.wait();\n  return tx.hash;\n}\n\nexport async function verifyByBank(propertyId) {\n  const contract = await getEVaultContract(true);\n  const tx = await contract.verifyByBank(propertyId);\n  await tx.wait();\n  return tx.hash;\n}\n\nexport async function getPropertyCounter() {\n  const contract = await getEVaultContract(false);\n  return Number(await contract.propertyCounter());\n}\n\nexport async function getProperty(propertyId) {\n  const contract = await getEVaultContract(false);\n  const property = await contract.properties(propertyId);\n  return {\n    id: Number(property.id),\n    owner: property.owner,\n    ipfsHash: property.ipfsHash,\n    registrarApproved: Boolean(property.registrarApproved),\n    notaryApproved: Boolean(property.notaryApproved),\n    authorityApproved: Boolean(property.authorityApproved),\n    approvalCount: Number(property.approvalCount),\n    status: Number(property.status),\n    bankVerified: Boolean(property.bankVerified),\n  };\n}\n\nexport async function getAllProperties() {\n  const count = await getPropertyCounter();\n  if (count === 0) return [];\n  const ids = Array.from({ length: count }, (_, i) => i + 1);\n  const properties = await Promise.all(ids.map((id) => getProperty(id)));\n  return properties.filter((property) => property.id > 0);\n}\n\nexport async function getOwnershipHistory(propertyId) {\n  const contract = await getEVaultContract(false);\n  const records = await contract.getOwnershipHistory(propertyId);\n  return records.map((record) => ({\n    owner: record.owner,\n    timestamp: Number(record.timestamp),\n    readableTime:\n      Number(record.timestamp) > 0\n        ? new Date(Number(record.timestamp) * 1000).toLocaleString()\n        : \"-\",\n  }));\n}\n\nexport function isValidAddress(value) {\n  return ethers.isAddress(value);\n}\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}